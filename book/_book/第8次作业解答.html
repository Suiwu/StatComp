<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 第8次作业解答 | 统计计算作业汇总</title>
  <meta name="description" content="这是用R的bookdown功能制作中文图书的模板，输出格式为bookdown::gitbook和bookdown::pdf_book." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="8 第8次作业解答 | 统计计算作业汇总" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="这是用R的bookdown功能制作中文图书的模板，输出格式为bookdown::gitbook和bookdown::pdf_book." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 第8次作业解答 | 统计计算作业汇总" />
  
  <meta name="twitter:description" content="这是用R的bookdown功能制作中文图书的模板，输出格式为bookdown::gitbook和bookdown::pdf_book." />
  

<meta name="author" content="兰敬国" />


<meta name="date" content="2021-12-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="第7次作业解答.html"/>
<link rel="next" href="第9次作业解答.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX","output/SVG"],
  extensions: ["tex2jax.js","MathMenu.js","MathZoom.js"],
  TeX: {
    extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
  }
});
</script>
<script type="text/javascript"
   src="../../../MathJax/MathJax.js">
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>简介</a></li>
<li class="chapter" data-level="1" data-path="第1次作业解答.html"><a href="第1次作业解答.html"><i class="fa fa-check"></i><b>1</b> 第1次作业解答</a>
<ul>
<li class="chapter" data-level="1.1" data-path="第1次作业解答.html"><a href="第1次作业解答.html#question"><i class="fa fa-check"></i><b>1.1</b> Question</a></li>
<li class="chapter" data-level="1.2" data-path="第1次作业解答.html"><a href="第1次作业解答.html#answer"><i class="fa fa-check"></i><b>1.2</b> Answer</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="第1次作业解答.html"><a href="第1次作业解答.html#texts"><i class="fa fa-check"></i><b>1.2.1</b> Texts</a></li>
<li class="chapter" data-level="1.2.2" data-path="第1次作业解答.html"><a href="第1次作业解答.html#figures"><i class="fa fa-check"></i><b>1.2.2</b> Figures</a></li>
<li class="chapter" data-level="1.2.3" data-path="第1次作业解答.html"><a href="第1次作业解答.html#ggplot2"><i class="fa fa-check"></i><b>1.2.3</b> ggplot2</a></li>
<li class="chapter" data-level="1.2.4" data-path="第1次作业解答.html"><a href="第1次作业解答.html#tables"><i class="fa fa-check"></i><b>1.2.4</b> Tables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="第2次作业解答.html"><a href="第2次作业解答.html"><i class="fa fa-check"></i><b>2</b> 第2次作业解答</a>
<ul>
<li class="chapter" data-level="2.1" data-path="第2次作业解答.html"><a href="第2次作业解答.html#question-1"><i class="fa fa-check"></i><b>2.1</b> Question</a></li>
<li class="chapter" data-level="2.2" data-path="第2次作业解答.html"><a href="第2次作业解答.html#answer-1"><i class="fa fa-check"></i><b>2.2</b> Answer</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="第2次作业解答.html"><a href="第2次作业解答.html#section"><i class="fa fa-check"></i><b>2.2.1</b> 3.4</a></li>
<li class="chapter" data-level="2.2.2" data-path="第2次作业解答.html"><a href="第2次作业解答.html#section-1"><i class="fa fa-check"></i><b>2.2.2</b> 3.11</a></li>
<li class="chapter" data-level="2.2.3" data-path="第2次作业解答.html"><a href="第2次作业解答.html#section-2"><i class="fa fa-check"></i><b>2.2.3</b> 3.20</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="第3次作业解答.html"><a href="第3次作业解答.html"><i class="fa fa-check"></i><b>3</b> 第3次作业解答</a>
<ul>
<li class="chapter" data-level="3.1" data-path="第3次作业解答.html"><a href="第3次作业解答.html#question-2"><i class="fa fa-check"></i><b>3.1</b> Question</a></li>
<li class="chapter" data-level="3.2" data-path="第3次作业解答.html"><a href="第3次作业解答.html#answer-2"><i class="fa fa-check"></i><b>3.2</b> Answer</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="第3次作业解答.html"><a href="第3次作业解答.html#section-3"><i class="fa fa-check"></i><b>3.2.1</b> 5.4</a></li>
<li class="chapter" data-level="3.2.2" data-path="第3次作业解答.html"><a href="第3次作业解答.html#section-4"><i class="fa fa-check"></i><b>3.2.2</b> 5.9</a></li>
<li class="chapter" data-level="3.2.3" data-path="第3次作业解答.html"><a href="第3次作业解答.html#section-5"><i class="fa fa-check"></i><b>3.2.3</b> 5.13</a></li>
<li class="chapter" data-level="3.2.4" data-path="第3次作业解答.html"><a href="第3次作业解答.html#section-6"><i class="fa fa-check"></i><b>3.2.4</b> 5.14</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="第4次作业解答.html"><a href="第4次作业解答.html"><i class="fa fa-check"></i><b>4</b> 第4次作业解答</a>
<ul>
<li class="chapter" data-level="4.1" data-path="第4次作业解答.html"><a href="第4次作业解答.html#question-3"><i class="fa fa-check"></i><b>4.1</b> Question</a></li>
<li class="chapter" data-level="4.2" data-path="第4次作业解答.html"><a href="第4次作业解答.html#answer-3"><i class="fa fa-check"></i><b>4.2</b> Answer</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="第4次作业解答.html"><a href="第4次作业解答.html#section-7"><i class="fa fa-check"></i><b>4.2.1</b> 6.5</a></li>
<li class="chapter" data-level="4.2.2" data-path="第4次作业解答.html"><a href="第4次作业解答.html#a"><i class="fa fa-check"></i><b>4.2.2</b> 6.A</a></li>
<li class="chapter" data-level="4.2.3" data-path="第4次作业解答.html"><a href="第4次作业解答.html#discussion"><i class="fa fa-check"></i><b>4.2.3</b> Discussion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="第5次作业解答.html"><a href="第5次作业解答.html"><i class="fa fa-check"></i><b>5</b> 第5次作业解答</a>
<ul>
<li class="chapter" data-level="5.1" data-path="第5次作业解答.html"><a href="第5次作业解答.html#question-4"><i class="fa fa-check"></i><b>5.1</b> Question</a></li>
<li class="chapter" data-level="5.2" data-path="第5次作业解答.html"><a href="第5次作业解答.html#answer-4"><i class="fa fa-check"></i><b>5.2</b> Answer</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="第5次作业解答.html"><a href="第5次作业解答.html#多元正态性的偏度检验6.8"><i class="fa fa-check"></i><b>5.2.1</b> 多元正态性的偏度检验(6.8)</a></li>
<li class="chapter" data-level="5.2.2" data-path="第5次作业解答.html"><a href="第5次作业解答.html#多元正态性偏度检验的功效6.10"><i class="fa fa-check"></i><b>5.2.2</b> 多元正态性偏度检验的功效(6.10)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="第6次作业解答.html"><a href="第6次作业解答.html"><i class="fa fa-check"></i><b>6</b> 第6次作业解答</a>
<ul>
<li class="chapter" data-level="6.1" data-path="第6次作业解答.html"><a href="第6次作业解答.html#question-5"><i class="fa fa-check"></i><b>6.1</b> Question</a></li>
<li class="chapter" data-level="6.2" data-path="第6次作业解答.html"><a href="第6次作业解答.html#answer-5"><i class="fa fa-check"></i><b>6.2</b> Answer</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="第6次作业解答.html"><a href="第6次作业解答.html#section-8"><i class="fa fa-check"></i><b>6.2.1</b> 7.7, 7.8, 7.9</a></li>
<li class="chapter" data-level="6.2.2" data-path="第6次作业解答.html"><a href="第6次作业解答.html#b"><i class="fa fa-check"></i><b>6.2.2</b> 7.B</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="第7次作业解答.html"><a href="第7次作业解答.html"><i class="fa fa-check"></i><b>7</b> 第7次作业解答</a>
<ul>
<li class="chapter" data-level="7.1" data-path="第7次作业解答.html"><a href="第7次作业解答.html#question-6"><i class="fa fa-check"></i><b>7.1</b> Question</a></li>
<li class="chapter" data-level="7.2" data-path="第7次作业解答.html"><a href="第7次作业解答.html#answer-6"><i class="fa fa-check"></i><b>7.2</b> Answer</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="第7次作业解答.html"><a href="第7次作业解答.html#section-9"><i class="fa fa-check"></i><b>7.2.1</b> 8.2</a></li>
<li class="chapter" data-level="7.2.2" data-path="第7次作业解答.html"><a href="第7次作业解答.html#discussion-1"><i class="fa fa-check"></i><b>7.2.2</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="第7次作业解答.html"><a href="第7次作业解答.html#unequal-variances-and-unequal-expectations"><i class="fa fa-check"></i><b>7.3</b> Unequal variances and unequal expectations</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="第8次作业解答.html"><a href="第8次作业解答.html"><i class="fa fa-check"></i><b>8</b> 第8次作业解答</a>
<ul>
<li class="chapter" data-level="8.1" data-path="第8次作业解答.html"><a href="第8次作业解答.html#question-7"><i class="fa fa-check"></i><b>8.1</b> Question</a></li>
<li class="chapter" data-level="8.2" data-path="第8次作业解答.html"><a href="第8次作业解答.html#answer-7"><i class="fa fa-check"></i><b>8.2</b> Answer</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="第8次作业解答.html"><a href="第8次作业解答.html#section-10"><i class="fa fa-check"></i><b>8.2.1</b> 9.3</a></li>
<li class="chapter" data-level="8.2.2" data-path="第8次作业解答.html"><a href="第8次作业解答.html#section-11"><i class="fa fa-check"></i><b>8.2.2</b> 9.8</a></li>
<li class="chapter" data-level="8.2.3" data-path="第8次作业解答.html"><a href="第8次作业解答.html#discussion-2"><i class="fa fa-check"></i><b>8.2.3</b> Discussion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="第9次作业解答.html"><a href="第9次作业解答.html"><i class="fa fa-check"></i><b>9</b> 第9次作业解答</a>
<ul>
<li class="chapter" data-level="9.1" data-path="第9次作业解答.html"><a href="第9次作业解答.html#question-8"><i class="fa fa-check"></i><b>9.1</b> Question</a></li>
<li class="chapter" data-level="9.2" data-path="第9次作业解答.html"><a href="第9次作业解答.html#answer-8"><i class="fa fa-check"></i><b>9.2</b> Answer</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="第9次作业解答.html"><a href="第9次作业解答.html#section-14"><i class="fa fa-check"></i><b>9.2.1</b> 11.3</a></li>
<li class="chapter" data-level="9.2.2" data-path="第9次作业解答.html"><a href="第9次作业解答.html#section-15"><i class="fa fa-check"></i><b>9.2.2</b> 11.5</a></li>
<li class="chapter" data-level="9.2.3" data-path="第9次作业解答.html"><a href="第9次作业解答.html#discussion-3"><i class="fa fa-check"></i><b>9.2.3</b> Discussion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="第10次作业解答.html"><a href="第10次作业解答.html"><i class="fa fa-check"></i><b>10</b> 第10次作业解答</a>
<ul>
<li class="chapter" data-level="10.1" data-path="第10次作业解答.html"><a href="第10次作业解答.html#question-9"><i class="fa fa-check"></i><b>10.1</b> Question</a></li>
<li class="chapter" data-level="10.2" data-path="第10次作业解答.html"><a href="第10次作业解答.html#answer-9"><i class="fa fa-check"></i><b>10.2</b> Answer</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="第10次作业解答.html"><a href="第10次作业解答.html#p204-1"><i class="fa fa-check"></i><b>10.2.1</b> P204-1</a></li>
<li class="chapter" data-level="10.2.2" data-path="第10次作业解答.html"><a href="第10次作业解答.html#p204-5"><i class="fa fa-check"></i><b>10.2.2</b> P204-5</a></li>
<li class="chapter" data-level="10.2.3" data-path="第10次作业解答.html"><a href="第10次作业解答.html#p214-1"><i class="fa fa-check"></i><b>10.2.3</b> P214-1</a></li>
<li class="chapter" data-level="10.2.4" data-path="第10次作业解答.html"><a href="第10次作业解答.html#p214-7"><i class="fa fa-check"></i><b>10.2.4</b> P214-7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="第11次作业解答.html"><a href="第11次作业解答.html"><i class="fa fa-check"></i><b>11</b> 第11次作业解答</a>
<ul>
<li class="chapter" data-level="11.1" data-path="第11次作业解答.html"><a href="第11次作业解答.html#question-10"><i class="fa fa-check"></i><b>11.1</b> Question</a></li>
<li class="chapter" data-level="11.2" data-path="第11次作业解答.html"><a href="第11次作业解答.html#answer-10"><i class="fa fa-check"></i><b>11.2</b> Answer</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="第11次作业解答.html"><a href="第11次作业解答.html#gibbs-in-r"><i class="fa fa-check"></i><b>11.2.1</b> Gibbs in R</a></li>
<li class="chapter" data-level="11.2.2" data-path="第11次作业解答.html"><a href="第11次作业解答.html#gibbs-in-c"><i class="fa fa-check"></i><b>11.2.2</b> Gibbs in C</a></li>
<li class="chapter" data-level="11.2.3" data-path="第11次作业解答.html"><a href="第11次作业解答.html#qq-plot"><i class="fa fa-check"></i><b>11.2.3</b> QQ plot</a></li>
<li class="chapter" data-level="11.2.4" data-path="第11次作业解答.html"><a href="第11次作业解答.html#time"><i class="fa fa-check"></i><b>11.2.4</b> Time</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">统计计算作业汇总</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="第8次作业解答" class="section level1" number="8">
<h1><span class="header-section-number">8</span> 第8次作业解答</h1>
<div id="question-7" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Question</h2>
<ul>
<li><p>Exercies 9.3 and 9.8 (pages 277-278, Statistical Computating
with R).</p></li>
<li><p>For each of the above exercise, use the Gelman-Rubin method
to monitor convergence of the chain, and run the chain until it
converges approximately to the target distribution according to
$R&lt; 1.2 $</p></li>
</ul>
</div>
<div id="answer-7" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Answer</h2>
<div id="section-10" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> 9.3</h3>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a Cauchy <span class="math inline">\((\theta, \eta)\)</span> distribution has density function
<span class="math display">\[
f(x)=\frac{1}{\theta \pi\left(1+[(x-\eta) / \theta]^{2}\right)}, \quad-\infty&lt;x&lt;\infty, \theta&gt;0
\]</span>
The standard Cauchy has the Cauchy <span class="math inline">\((\theta=1, \eta=0)\)</span> density. (Note that the standard Cauchy density is equal to the Student <span class="math inline">\(\mathrm{t}\)</span> density with one degree of freedom.)</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="第8次作业解答.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb68-2"><a href="第8次作业解答.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="do">## standard Cauchy </span></span>
<span id="cb68-3"><a href="第8次作业解答.html#cb68-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb68-4"><a href="第8次作业解答.html#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span>(pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb68-5"><a href="第8次作业解答.html#cb68-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-6"><a href="第8次作业解答.html#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="第8次作业解答.html#cb68-7" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb68-8"><a href="第8次作业解答.html#cb68-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb68-9"><a href="第8次作业解答.html#cb68-9" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb68-10"><a href="第8次作业解答.html#cb68-10" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb68-11"><a href="第8次作业解答.html#cb68-11" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb68-12"><a href="第8次作业解答.html#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb68-13"><a href="第8次作业解答.html#cb68-13" aria-hidden="true" tabindex="-1"></a>  xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb68-14"><a href="第8次作业解答.html#cb68-14" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> xt)</span>
<span id="cb68-15"><a href="第8次作业解答.html#cb68-15" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">&lt;-</span> <span class="fu">f</span>(y) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, <span class="at">mean =</span> y)</span>
<span id="cb68-16"><a href="第8次作业解答.html#cb68-16" aria-hidden="true" tabindex="-1"></a>  den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt) <span class="sc">*</span> <span class="fu">dnorm</span>(y, <span class="at">mean =</span> xt)</span>
<span id="cb68-17"><a href="第8次作业解答.html#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb68-18"><a href="第8次作业解答.html#cb68-18" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb68-19"><a href="第8次作业解答.html#cb68-19" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span> <span class="co">#y is rejected</span></span>
<span id="cb68-20"><a href="第8次作业解答.html#cb68-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-21"><a href="第8次作业解答.html#cb68-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-22"><a href="第8次作业解答.html#cb68-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-23"><a href="第8次作业解答.html#cb68-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-24"><a href="第8次作业解答.html#cb68-24" aria-hidden="true" tabindex="-1"></a><span class="do">## MC过程图</span></span>
<span id="cb68-25"><a href="第8次作业解答.html#cb68-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>m, x, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="08_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="第8次作业解答.html#cb69-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb69-2"><a href="第8次作业解答.html#cb69-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x[b<span class="sc">:</span>m]</span>
<span id="cb69-3"><a href="第8次作业解答.html#cb69-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">1000</span>)</span>
<span id="cb69-4"><a href="第8次作业解答.html#cb69-4" aria-hidden="true" tabindex="-1"></a>Qc <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(a) </span>
<span id="cb69-5"><a href="第8次作业解答.html#cb69-5" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, a)</span>
<span id="cb69-6"><a href="第8次作业解答.html#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="第8次作业解答.html#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="第8次作业解答.html#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="do">## QQ图</span></span>
<span id="cb69-9"><a href="第8次作业解答.html#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(Qc, Q, <span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="at">xlab=</span><span class="st">&quot;Standard Cauchy Quantiles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span></code></pre></div>
<p><img src="08_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="第8次作业解答.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 直方图</span></span>
<span id="cb70-2"><a href="第8次作业解答.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb70-3"><a href="第8次作业解答.html#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Qc, <span class="fu">f</span>(Qc))</span></code></pre></div>
<p><img src="08_files/figure-html/unnamed-chunk-1-3.png" width="672" /></p>
</div>
<div id="section-11" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> 9.8</h3>
<p>This example appears in [40]. Consider the bivariate density
<span class="math display">\[
f(x, y) \propto\left(\begin{array}{l}
n \\
x
\end{array}\right) y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1, \ldots, n, 0 \leq y \leq 1
\]</span>
It can be shown (see e.g. <span class="math inline">\([23]\)</span> ) that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions are <span class="math inline">\(\operatorname{Binomial}(n, y)\)</span> and <span class="math inline">\(\operatorname{Beta}(x+a, n-x+b)\)</span>. Use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="第8次作业解答.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb71-2"><a href="第8次作业解答.html#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="第8次作业解答.html#cb71-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb71-4"><a href="第8次作业解答.html#cb71-4" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb71-5"><a href="第8次作业解答.html#cb71-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb71-6"><a href="第8次作业解答.html#cb71-6" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb71-7"><a href="第8次作业解答.html#cb71-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb71-8"><a href="第8次作业解答.html#cb71-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb71-9"><a href="第8次作业解答.html#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="第8次作业解答.html#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize</span></span>
<span id="cb71-11"><a href="第8次作业解答.html#cb71-11" aria-hidden="true" tabindex="-1"></a>x0<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb71-12"><a href="第8次作业解答.html#cb71-12" aria-hidden="true" tabindex="-1"></a>y0<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb71-13"><a href="第8次作业解答.html#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="do">###### generate the chain #####</span></span>
<span id="cb71-14"><a href="第8次作业解答.html#cb71-14" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x0,y0) <span class="co">#initialize</span></span>
<span id="cb71-15"><a href="第8次作业解答.html#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb71-16"><a href="第8次作业解答.html#cb71-16" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb71-17"><a href="第8次作业解答.html#cb71-17" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="at">size=</span>n,<span class="at">prob =</span> y)</span>
<span id="cb71-18"><a href="第8次作业解答.html#cb71-18" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb71-19"><a href="第8次作业解答.html#cb71-19" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb71-20"><a href="第8次作业解答.html#cb71-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-21"><a href="第8次作业解答.html#cb71-21" aria-hidden="true" tabindex="-1"></a>lab <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb71-22"><a href="第8次作业解答.html#cb71-22" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> X[lab<span class="sc">:</span>N, ]</span>
<span id="cb71-23"><a href="第8次作业解答.html#cb71-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[,<span class="dv">1</span>],X[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="08_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="第8次作业解答.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;协方差矩阵</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 协方差矩阵</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="第8次作业解答.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(out) <span class="do">## 协方差矩阵</span></span></code></pre></div>
<pre><code>##             [,1]        [,2]
## [1,] 30062.95389 29.91243495
## [2,]    29.91243  0.02994719</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="第8次作业解答.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;相关系数矩阵</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 相关系数矩阵</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="第8次作业解答.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(out) <span class="do">## 相关系数矩阵</span></span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 1.0000000 0.9969145
## [2,] 0.9969145 1.0000000</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="第8次作业解答.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(X[<span class="dv">1</span>]),</span>
<span id="cb80-2"><a href="第8次作业解答.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="at">ylab=</span><span class="fu">bquote</span>(X[<span class="dv">2</span>]), <span class="at">ylim=</span><span class="fu">range</span>(out[,<span class="dv">2</span>]))  <span class="do">## 分布图</span></span></code></pre></div>
<p><img src="08_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="discussion-2" class="section level3" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Discussion</h3>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R&lt;1.2\)</span></p>
<p>解答：</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="第8次作业解答.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算Gelman-Rubin statistic的函数</span></span>
<span id="cb81-2"><a href="第8次作业解答.html#cb81-2" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb81-3"><a href="第8次作业解答.html#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb81-4"><a href="第8次作业解答.html#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb81-5"><a href="第8次作业解答.html#cb81-5" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb81-6"><a href="第8次作业解答.html#cb81-6" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb81-7"><a href="第8次作业解答.html#cb81-7" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb81-8"><a href="第8次作业解答.html#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="第8次作业解答.html#cb81-9" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb81-10"><a href="第8次作业解答.html#cb81-10" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb81-11"><a href="第8次作业解答.html#cb81-11" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb81-12"><a href="第8次作业解答.html#cb81-12" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb81-13"><a href="第8次作业解答.html#cb81-13" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb81-14"><a href="第8次作业解答.html#cb81-14" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb81-15"><a href="第8次作业解答.html#cb81-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb81-16"><a href="第8次作业解答.html#cb81-16" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<div id="section-12" class="section level4" number="8.2.3.1">
<h4><span class="header-section-number">8.2.3.1</span> 9.3</h4>
<p>先按照9.3题写出构造标准柯西分布的Metropolis chain的函数</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="第8次作业解答.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成标准柯西分布的Metropolis chain</span></span>
<span id="cb82-2"><a href="第8次作业解答.html#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 提议函数仍取9.3中使用的对称正态分布 N(0,X[t]^2)</span></span>
<span id="cb82-3"><a href="第8次作业解答.html#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co"># X1为初始值</span></span>
<span id="cb82-4"><a href="第8次作业解答.html#cb82-4" aria-hidden="true" tabindex="-1"></a>Standard_Cauchy_Chain <span class="ot">&lt;-</span> <span class="cf">function</span>(N, X1){</span>
<span id="cb82-5"><a href="第8次作业解答.html#cb82-5" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb82-6"><a href="第8次作业解答.html#cb82-6" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1    <span class="co">#初始值</span></span>
<span id="cb82-7"><a href="第8次作业解答.html#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb82-8"><a href="第8次作业解答.html#cb82-8" aria-hidden="true" tabindex="-1"></a>    Xt <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>]</span>
<span id="cb82-9"><a href="第8次作业解答.html#cb82-9" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="fu">abs</span>(Xt))</span>
<span id="cb82-10"><a href="第8次作业解答.html#cb82-10" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">dt</span>(Y,<span class="dv">1</span>)<span class="sc">*</span><span class="fu">dnorm</span>(Xt,<span class="dv">0</span>,<span class="fu">abs</span>(Y))<span class="sc">/</span><span class="fu">dt</span>(Xt,<span class="dv">1</span>)<span class="sc">/</span><span class="fu">dnorm</span>(Y,<span class="dv">0</span>,<span class="fu">abs</span>(Xt))</span>
<span id="cb82-11"><a href="第8次作业解答.html#cb82-11" aria-hidden="true" tabindex="-1"></a>    U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb82-12"><a href="第8次作业解答.html#cb82-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(r <span class="sc">&gt;</span> <span class="dv">1</span>) r <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb82-13"><a href="第8次作业解答.html#cb82-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(U <span class="sc">&lt;=</span> r) X[i] <span class="ot">&lt;-</span> Y</span>
<span id="cb82-14"><a href="第8次作业解答.html#cb82-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> X[i] <span class="ot">&lt;-</span> Xt</span>
<span id="cb82-15"><a href="第8次作业解答.html#cb82-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb82-16"><a href="第8次作业解答.html#cb82-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb82-17"><a href="第8次作业解答.html#cb82-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>接下来不妨考虑生成4条上述Metropolis chain，每条样本量N=8000。</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="第8次作业解答.html#cb83-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span>      </span>
<span id="cb83-2"><a href="第8次作业解答.html#cb83-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">8000</span></span>
<span id="cb83-3"><a href="第8次作业解答.html#cb83-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span>     <span class="co">#burn-in length</span></span>
<span id="cb83-4"><a href="第8次作业解答.html#cb83-4" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>)    <span class="co">#初始值</span></span>
<span id="cb83-5"><a href="第8次作业解答.html#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="第8次作业解答.html#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成4条样本</span></span>
<span id="cb83-7"><a href="第8次作业解答.html#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb83-8"><a href="第8次作业解答.html#cb83-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> N)</span>
<span id="cb83-9"><a href="第8次作业解答.html#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb83-10"><a href="第8次作业解答.html#cb83-10" aria-hidden="true" tabindex="-1"></a>  X[i,] <span class="ot">&lt;-</span> <span class="fu">Standard_Cauchy_Chain</span>(N, X1[i])</span>
<span id="cb83-11"><a href="第8次作业解答.html#cb83-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-12"><a href="第8次作业解答.html#cb83-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-13"><a href="第8次作业解答.html#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="co"># compute diagnostic statistics</span></span>
<span id="cb83-14"><a href="第8次作业解答.html#cb83-14" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb83-15"><a href="第8次作业解答.html#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb83-16"><a href="第8次作业解答.html#cb83-16" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb83-17"><a href="第8次作业解答.html#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.127139</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="第8次作业解答.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 四条样本的psi</span></span>
<span id="cb85-2"><a href="第8次作业解答.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb85-3"><a href="第8次作业解答.html#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb85-4"><a href="第8次作业解答.html#cb85-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb85-5"><a href="第8次作业解答.html#cb85-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="at">ylab=</span><span class="fu">bquote</span>(phi))</span>
<span id="cb85-6"><a href="第8次作业解答.html#cb85-6" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb85-7"><a href="第8次作业解答.html#cb85-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lines</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">col=</span>i)</span>
<span id="cb85-8"><a href="第8次作业解答.html#cb85-8" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<p><img src="08_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="第8次作业解答.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) </span></code></pre></div>
<p>实际上发现四条样本的psi图并没有呈现逼近同一分布的结果，这可能是因为Cauchy分布的期望和方差不均存在，进而导致的估计不稳定性，下面再画出<span class="math inline">\(\hat R\)</span>统计量v.s.样本量N的图。</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="第8次作业解答.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) </span>
<span id="cb87-2"><a href="第8次作业解答.html#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb87-3"><a href="第8次作业解答.html#cb87-3" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb87-4"><a href="第8次作业解答.html#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb87-5"><a href="第8次作业解答.html#cb87-5" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb87-6"><a href="第8次作业解答.html#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb87-7"><a href="第8次作业解答.html#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="08_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p><span class="math inline">\(\hat R\)</span> 大概在样本为1000时达到收敛。</p>
</div>
<div id="section-13" class="section level4" number="8.2.3.2">
<h4><span class="header-section-number">8.2.3.2</span> 9.8</h4>
<p>先按照9.8题写出题中二元随机变量的Gibbs sampler，这里不妨取a=b=1。</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="第8次作业解答.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成二元随机变量的Gibbs sampler</span></span>
<span id="cb88-2"><a href="第8次作业解答.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co"># X1为初始值</span></span>
<span id="cb88-3"><a href="第8次作业解答.html#cb88-3" aria-hidden="true" tabindex="-1"></a>Bivariate.Gibbs <span class="ot">&lt;-</span> <span class="cf">function</span>(N, X1){</span>
<span id="cb88-4"><a href="第8次作业解答.html#cb88-4" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb88-5"><a href="第8次作业解答.html#cb88-5" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb88-6"><a href="第8次作业解答.html#cb88-6" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> X1    <span class="co">#初始值</span></span>
<span id="cb88-7"><a href="第8次作业解答.html#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb88-8"><a href="第8次作业解答.html#cb88-8" aria-hidden="true" tabindex="-1"></a>    X2 <span class="ot">&lt;-</span>  X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb88-9"><a href="第8次作业解答.html#cb88-9" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">25</span>,X2)</span>
<span id="cb88-10"><a href="第8次作业解答.html#cb88-10" aria-hidden="true" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb88-11"><a href="第8次作业解答.html#cb88-11" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X1<span class="sc">+</span>a,<span class="dv">25</span><span class="sc">-</span>X1<span class="sc">+</span>b)</span>
<span id="cb88-12"><a href="第8次作业解答.html#cb88-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-13"><a href="第8次作业解答.html#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb88-14"><a href="第8次作业解答.html#cb88-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>不妨还是考虑生成4条样本，每条样本量N=8000.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="第8次作业解答.html#cb89-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span>          </span>
<span id="cb89-2"><a href="第8次作业解答.html#cb89-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">8000</span> </span>
<span id="cb89-3"><a href="第8次作业解答.html#cb89-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span>    <span class="co">#burn-in length</span></span>
<span id="cb89-4"><a href="第8次作业解答.html#cb89-4" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">15</span>),<span class="fu">runif</span>(<span class="dv">4</span>)) <span class="co">#初始值</span></span>
<span id="cb89-5"><a href="第8次作业解答.html#cb89-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-6"><a href="第8次作业解答.html#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="co">#生成4条样本，每个第一维的放在X中，第二维的放在Y中</span></span>
<span id="cb89-7"><a href="第8次作业解答.html#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb89-8"><a href="第8次作业解答.html#cb89-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>N)</span>
<span id="cb89-9"><a href="第8次作业解答.html#cb89-9" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>N)</span>
<span id="cb89-10"><a href="第8次作业解答.html#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb89-11"><a href="第8次作业解答.html#cb89-11" aria-hidden="true" tabindex="-1"></a>  BG <span class="ot">&lt;-</span> <span class="fu">Bivariate.Gibbs</span>(N, X1[i,])</span>
<span id="cb89-12"><a href="第8次作业解答.html#cb89-12" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> BG[,<span class="dv">1</span>]</span>
<span id="cb89-13"><a href="第8次作业解答.html#cb89-13" aria-hidden="true" tabindex="-1"></a>  Y[i, ] <span class="ot">&lt;-</span> BG[,<span class="dv">2</span>]</span>
<span id="cb89-14"><a href="第8次作业解答.html#cb89-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>下面分别在每一个维度上考虑利用Gelman-Rubin method考虑样本的收敛情况。</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="第8次作业解答.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 先考虑第一维样本X</span></span>
<span id="cb90-2"><a href="第8次作业解答.html#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="第8次作业解答.html#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb90-4"><a href="第8次作业解答.html#cb90-4" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb90-5"><a href="第8次作业解答.html#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb90-6"><a href="第8次作业解答.html#cb90-6" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb90-7"><a href="第8次作业解答.html#cb90-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-8"><a href="第8次作业解答.html#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb90-9"><a href="第8次作业解答.html#cb90-9" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb90-10"><a href="第8次作业解答.html#cb90-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb90-11"><a href="第8次作业解答.html#cb90-11" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb90-12"><a href="第8次作业解答.html#cb90-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb90-13"><a href="第8次作业解答.html#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="08_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="第8次作业解答.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 再考虑第二维样本Y</span></span>
<span id="cb91-2"><a href="第8次作业解答.html#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="第8次作业解答.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb91-4"><a href="第8次作业解答.html#cb91-4" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Y, <span class="dv">1</span>, cumsum))</span>
<span id="cb91-5"><a href="第8次作业解答.html#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb91-6"><a href="第8次作业解答.html#cb91-6" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb91-7"><a href="第8次作业解答.html#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="第8次作业解答.html#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb91-9"><a href="第8次作业解答.html#cb91-9" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb91-10"><a href="第8次作业解答.html#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb91-11"><a href="第8次作业解答.html#cb91-11" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb91-12"><a href="第8次作业解答.html#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb91-13"><a href="第8次作业解答.html#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="08_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>综合考虑两个维度的<span class="math inline">\(\hat R\)</span>统计量，大约在样本为4000时可以达到收敛。</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="第7次作业解答.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="第9次作业解答.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["CBook.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
