<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jingguo Lan" />

<meta name="date" content="2021-12-22" />

<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Jingguo Lan</h4>
<h4 class="date">2021-12-22</h4>



<div id="第1次作业解答" class="section level1">
<h1>第1次作业解答</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Produce 3 examples(texts,figures,tables)</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="texts" class="section level3">
<h3>Texts</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;今天&quot;</span>,<span class="st">&quot;吃饭&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;你&quot;</span>,<span class="st">&quot;了吗?&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="fu">paste0</span>(a,b,<span class="at">collapse=</span><span class="st">&quot;&quot;</span>)  <span class="do">## 拼接字符串a,b</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>## [1] &quot;今天你吃饭了吗?&quot;</code></pre>
</div>
<div id="figures" class="section level3">
<h3>Figures</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 从均值为100，方差为1的正态分布中，随机生成30个数</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean=</span><span class="dv">100</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(x,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>##  [1]  99.09 100.00  99.13 100.16  99.32  99.66 100.52 100.27 100.50 100.33
## [11]  99.87  99.07 100.56 100.47 100.21  98.79  99.20  99.65 101.72  99.23
## [21] 100.90 100.11 100.20 101.07 100.97  99.61  99.81  99.12  98.42 100.64</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 30个随机数的散点图</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="at">main=</span><span class="st">&quot;散点图&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 30个随机数的直方图</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">15</span>), </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&#39;正态随机数&#39;</span>, <span class="at">xlab=</span><span class="st">&#39;&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;频数&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="ggplot2" class="section level3">
<h3>ggplot2</h3>
<p>ggplot2包的mpg数据集:(从1999年到2008年38款流行车型的燃油经济性数据) ，234*11的数据规模，记录了制造厂商，型号，类别，驱动程序和耗油量</p>
<ul>
<li>cty 和hwy分别记录城市和高速公路驾驶耗油量</li>
<li>cyl:气缸数</li>
<li>displ:发动机排量</li>
<li>drv:驱动系统：前轮驱动(f)、后轮驱动和四轮驱动(4)</li>
<li>class:车辆类型,如双座汽车,suv,小型汽车</li>
<li>fl:燃料类型</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 用ggplot2画图</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mpg)  <span class="do">## 导入mpg数据集</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg,<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>cty,<span class="at">y=</span>hwy,<span class="at">color=</span><span class="fu">factor</span>(year)))<span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&#39;loess&#39;</span>)<span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&#39;每加仑高速公路行驶距离&#39;</span>, <span class="at">x =</span> <span class="st">&#39;每加仑城市公路行驶距离&#39;</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&#39;汽车油耗与型号&#39;</span>, <span class="at">size =</span> <span class="st">&#39;排量&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;车型&#39;</span>)<span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="tables" class="section level3">
<h3>Tables</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">## 显示表格</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(mpg))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">manufacturer</th>
<th align="left">model</th>
<th align="right">displ</th>
<th align="right">year</th>
<th align="right">cyl</th>
<th align="left">trans</th>
<th align="left">drv</th>
<th align="right">cty</th>
<th align="right">hwy</th>
<th align="left">fl</th>
<th align="left">class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">audi</td>
<td align="left">a4</td>
<td align="right">1.8</td>
<td align="right">1999</td>
<td align="right">4</td>
<td align="left">auto(l5)</td>
<td align="left">f</td>
<td align="right">18</td>
<td align="right">29</td>
<td align="left">p</td>
<td align="left">compact</td>
</tr>
<tr class="even">
<td align="left">audi</td>
<td align="left">a4</td>
<td align="right">1.8</td>
<td align="right">1999</td>
<td align="right">4</td>
<td align="left">manual(m5)</td>
<td align="left">f</td>
<td align="right">21</td>
<td align="right">29</td>
<td align="left">p</td>
<td align="left">compact</td>
</tr>
<tr class="odd">
<td align="left">audi</td>
<td align="left">a4</td>
<td align="right">2.0</td>
<td align="right">2008</td>
<td align="right">4</td>
<td align="left">manual(m6)</td>
<td align="left">f</td>
<td align="right">20</td>
<td align="right">31</td>
<td align="left">p</td>
<td align="left">compact</td>
</tr>
<tr class="even">
<td align="left">audi</td>
<td align="left">a4</td>
<td align="right">2.0</td>
<td align="right">2008</td>
<td align="right">4</td>
<td align="left">auto(av)</td>
<td align="left">f</td>
<td align="right">21</td>
<td align="right">30</td>
<td align="left">p</td>
<td align="left">compact</td>
</tr>
<tr class="odd">
<td align="left">audi</td>
<td align="left">a4</td>
<td align="right">2.8</td>
<td align="right">1999</td>
<td align="right">6</td>
<td align="left">auto(l5)</td>
<td align="left">f</td>
<td align="right">16</td>
<td align="right">26</td>
<td align="left">p</td>
<td align="left">compact</td>
</tr>
<tr class="even">
<td align="left">audi</td>
<td align="left">a4</td>
<td align="right">2.8</td>
<td align="right">1999</td>
<td align="right">6</td>
<td align="left">manual(m5)</td>
<td align="left">f</td>
<td align="right">18</td>
<td align="right">26</td>
<td align="left">p</td>
<td align="left">compact</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="第2次作业解答" class="section level1">
<h1>第2次作业解答</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>3.4, 3.11, and 3.20</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="section" class="section level3">
<h3>3.4</h3>
<p>The Rayleigh density [156, Ch. 18] is <span class="math display">\[
f(x)=\frac{x}{\sigma^{2}} e^{-x^{2} /\left(2 \sigma^{2}\right)}, \quad x \geq 0, \sigma&gt;0 .
\]</span> Develop an algorithm to generate random samples from a Rayleigh <span class="math inline">\((\sigma)\)</span> distribution. Generate Rayleigh <span class="math inline">\((\sigma)\)</span> samples for several choices of <span class="math inline">\(\sigma&gt;0\)</span> and check that the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span> (check the histogram).</p>
<p><em>解:</em></p>
<p>Rayleigh随机变量<span class="math inline">\(X\)</span>的分布函数: <span class="math display">\[
F(x)=1-\exp \left(-\frac{x^{2}}{2 \sigma^{2}}\right), x \geq 0
\]</span> 所以<span class="math inline">\(F^{-1}(y)=\sigma \sqrt{-2 \ln (1-y)}\)</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Rayleigh <span class="ot">=</span><span class="cf">function</span>(sigma, n){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    U<span class="ot">=</span><span class="fu">runif</span>(n)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    V<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>U</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(V))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">Rayleigh</span>(sigma, n),<span class="at">main =</span> <span class="st">&quot;Rayleigh&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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paCojxw/mnVQCor6yPGjJQgFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoC+BdUSN8coOfSiEdoha+zUO9C9fGitBbvgtRacYXE0G5VHZVLU1PIRnOL6ijHBY1P8C3ITHCQLGtuFrkQLlekV8eS/nW3JZBO8C3IKtllKctsajbJ7xJBrz+6vRakA++C9CnKV2mSvby0iioqg4qrf5cW5ZoE34JMjhDmC+k8GnXliATlavakn9dZNkwrqJCV0eKXMpl1RB1ffXHMpJeYcB6WjikTpP9uvcaRH6YspHNhaZHX01pwss1/jNeierpq3nJtb1EOMtNMo77E5A3F1zur2kbWklallY+nt/f472rkwq5GfeFI6zthV6Ow6b5IYGcVQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgwP/3KZfrtC1qBQAAAABJRU5ErkJggg==" /><!-- --></p>
<div id="多试几组sigma" class="section level4">
<h4>多试几组sigma</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>){</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  title<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;sigma=&quot;</span>,sigma[i])</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(<span class="fu">Rayleigh</span>(sigma[i], n),<span class="at">main =</span> title,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="section-1" class="section level3">
<h3>3.11</h3>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> distributions with mixing probabilities <span class="math inline">\(p_{1}\)</span> and <span class="math inline">\(p_{2}=1-p_{1}\)</span>. Graph the histogram of the sample with density superimposed, for <span class="math inline">\(p_{1}=0.75 .\)</span> Repeat with different values for <span class="math inline">\(p_{1}\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of <span class="math inline">\(p_{1}\)</span> that produce bimodal mixtures.</p>
<div id="p1取0.75" class="section level4">
<h4>p1取0.75</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>X1<span class="ot">=</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>X2<span class="ot">=</span><span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span><span class="fu">as.integer</span>(u <span class="sc">&lt;</span> <span class="fl">0.75</span>) </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">=</span>p1<span class="sc">*</span>X1<span class="sc">+</span>p2<span class="sc">*</span>X2</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(Z,<span class="at">main =</span> <span class="st">&quot;p1=0.75&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="p1从0变化到1" class="section level4">
<h4>p1从0变化到1</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>){</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  p1<span class="ot">=</span><span class="fu">as.integer</span>(u <span class="sc">&lt;</span> p[i]) </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  p2<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  Z<span class="ot">=</span>p1<span class="sc">*</span>X1<span class="sc">+</span>p2<span class="sc">*</span>X2</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  title<span class="ot">=</span><span class="fu">paste0</span>(<span class="st">&quot;p1=&quot;</span>,p[i])</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(Z,<span class="at">main=</span>title)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>把<span class="math inline">\(p1\)</span>的值从0变化到1，发现: 当<span class="math inline">\(p1\)</span>在<span class="math inline">\(0.5\)</span>附近的时候容易出现双峰.</p>
</div>
</div>
<div id="section-2" class="section level3">
<h3>3.20</h3>
<p>A compound Poisson process is a stochastic process <span class="math inline">\(\{X(t), t \geq 0\}\)</span> that can be represented as the random sum <span class="math inline">\(X(t)=\sum_{i=1}^{N(t)} Y_{i}, t \geq 0\)</span>, where <span class="math inline">\(\{N(t), t \geq 0\}\)</span> is a Poisson process and <span class="math inline">\(Y_{1}, Y_{2}, \ldots\)</span> are id and independent of <span class="math inline">\(\{N(t), t \geq 0\}\)</span>. Write a program to simulate a compound Poisson <span class="math inline">\((\lambda)\)</span>-Gamma process <span class="math inline">\((Y\)</span> has a Gamma distribution). Estimate the mean and the variance of <span class="math inline">\(X(10)\)</span> for several choices of the parameters and compare with the theoretical values. Hint: Show that <span class="math inline">\(E[X(t)]=\lambda t E\left[Y_{1}\right]\)</span> and <span class="math inline">\(\operatorname{Var}(X(t))=\lambda t E\left[Y_{1}^{2}\right]\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Poisson_Gamma<span class="ot">=</span><span class="cf">function</span>(n, t, lambda, r, beta) {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span><span class="fu">rpois</span>(n, lambda <span class="sc">*</span> t)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">=</span><span class="fu">sapply</span>(N, <span class="cf">function</span>(N, r, beta) <span class="fu">sum</span>(<span class="fu">rgamma</span>(N, r,beta)), r,beta)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>test<span class="ot">=</span><span class="cf">function</span>(n, t, lambda, r, beta) {</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">Poisson_Gamma</span>(n, t, lambda, r,beta)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 样本均值</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  sm<span class="ot">=</span><span class="fu">mean</span>(x) </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 理论均值</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  vm<span class="ot">=</span><span class="fu">var</span>(x)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 样本方差</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  tm<span class="ot">=</span>lambda <span class="sc">*</span> t <span class="sc">*</span> r<span class="sc">/</span>beta</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 理论方差</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  tv<span class="ot">=</span>lambda <span class="sc">*</span> t <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> r) <span class="sc">*</span> r<span class="sc">/</span>beta<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="do">## 输出结果样式</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;r=&quot;</span>,r,<span class="st">&quot;beta=&quot;</span>,beta,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;样本均值:&quot;</span>, sm, <span class="st">&quot;  &quot;</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;理论均值:&quot;</span>, vm, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;样本方差:&quot;</span>, tm, <span class="st">&quot;  &quot;</span>)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;理论方差:&quot;</span>, tv, <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="do">## 参数值</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>lambda_seq<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>r_seq<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>beta_seq<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>t<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (lambda <span class="cf">in</span> lambda_seq) {</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (r <span class="cf">in</span> r_seq) {</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (beta <span class="cf">in</span> beta_seq) {</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">test</span>(n, t, lambda,r,beta)</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## r= 1 beta= 1 
## 样本均值: 9.979661   理论均值: 22.02063 
## 样本方差: 10   理论方差: 20 
## 
## r= 1 beta= 2 
## 样本均值: 5.006659   理论均值: 4.990152 
## 样本方差: 5   理论方差: 5 
## 
## r= 1 beta= 3 
## 样本均值: 3.368767   理论均值: 2.383611 
## 样本方差: 3.333333   理论方差: 2.222222 
## 
## r= 2 beta= 1 
## 样本均值: 19.84   理论均值: 59.4685 
## 样本方差: 20   理论方差: 60 
## 
## r= 2 beta= 2 
## 样本均值: 10.0368   理论均值: 16.02193 
## 样本方差: 10   理论方差: 15 
## 
## r= 2 beta= 3 
## 样本均值: 6.753433   理论均值: 6.65136 
## 样本方差: 6.666667   理论方差: 6.666667 
## 
## r= 3 beta= 1 
## 样本均值: 30.41596   理论均值: 108.9713 
## 样本方差: 30   理论方差: 120 
## 
## r= 3 beta= 2 
## 样本均值: 15.09776   理论均值: 30.62767 
## 样本方差: 15   理论方差: 30 
## 
## r= 3 beta= 3 
## 样本均值: 10.23032   理论均值: 14.0003 
## 样本方差: 10   理论方差: 13.33333 
## 
## r= 1 beta= 1 
## 样本均值: 20.08963   理论均值: 41.57417 
## 样本方差: 20   理论方差: 40 
## 
## r= 1 beta= 2 
## 样本均值: 10.08574   理论均值: 9.718474 
## 样本方差: 10   理论方差: 10 
## 
## r= 1 beta= 3 
## 样本均值: 6.635761   理论均值: 4.796992 
## 样本方差: 6.666667   理论方差: 4.444444 
## 
## r= 2 beta= 1 
## 样本均值: 39.73904   理论均值: 120.4132 
## 样本方差: 40   理论方差: 120 
## 
## r= 2 beta= 2 
## 样本均值: 20.12312   理论均值: 30.85966 
## 样本方差: 20   理论方差: 30 
## 
## r= 2 beta= 3 
## 样本均值: 13.46478   理论均值: 13.67185 
## 样本方差: 13.33333   理论方差: 13.33333 
## 
## r= 3 beta= 1 
## 样本均值: 59.82453   理论均值: 236.8 
## 样本方差: 60   理论方差: 240 
## 
## r= 3 beta= 2 
## 样本均值: 30.22163   理论均值: 59.86679 
## 样本方差: 30   理论方差: 60 
## 
## r= 3 beta= 3 
## 样本均值: 20.23198   理论均值: 25.38053 
## 样本方差: 20   理论方差: 26.66667 
## 
## r= 1 beta= 1 
## 样本均值: 30.25403   理论均值: 59.39678 
## 样本方差: 30   理论方差: 60 
## 
## r= 1 beta= 2 
## 样本均值: 15.31441   理论均值: 14.81197 
## 样本方差: 15   理论方差: 15 
## 
## r= 1 beta= 3 
## 样本均值: 10.00195   理论均值: 7.005339 
## 样本方差: 10   理论方差: 6.666667 
## 
## r= 2 beta= 1 
## 样本均值: 60.48681   理论均值: 174.6903 
## 样本方差: 60   理论方差: 180 
## 
## r= 2 beta= 2 
## 样本均值: 30.16381   理论均值: 43.91282 
## 样本方差: 30   理论方差: 45 
## 
## r= 2 beta= 3 
## 样本均值: 19.9658   理论均值: 22.19539 
## 样本方差: 20   理论方差: 20 
## 
## r= 3 beta= 1 
## 样本均值: 89.7597   理论均值: 358.4306 
## 样本方差: 90   理论方差: 360 
## 
## r= 3 beta= 2 
## 样本均值: 45.15019   理论均值: 87.97748 
## 样本方差: 45   理论方差: 90 
## 
## r= 3 beta= 3 
## 样本均值: 29.76329   理论均值: 40.07169 
## 样本方差: 30   理论方差: 40</code></pre>
</div>
</div>
</div>
<div id="第3次作业解答" class="section level1">
<h1>第3次作业解答</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 5.4, 5.9, 5.13, and 5.14</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="section-3" class="section level3">
<h3>5.4</h3>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3, 3) cdf, and use the function to estimate F(x) for x = 0.1, 0.2, . . ., 0.9. Compare the estimates with the values returned by the pbeta function in R.</p>
<p>Solution: <span class="math inline">\(Beta(3,3)=\int_0^1 t^2(1-t)^2dt\)</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>MCBeta <span class="ot">=</span> <span class="cf">function</span>(x,<span class="at">n=</span><span class="dv">10000</span>){</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  t<span class="ot">=</span><span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> x)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  theta.hat<span class="ot">=</span>x<span class="sc">*</span><span class="fu">mean</span>(t<span class="sc">*</span>t<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>t))<span class="sc">/</span><span class="fu">beta</span>(<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(theta.hat)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>MC.Beta<span class="ot">=</span>pbeta<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">9</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  MC.Beta[i]<span class="ot">=</span><span class="fu">MCBeta</span>(x[i])</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  pbeta[i]<span class="ot">=</span><span class="fu">pbeta</span>(x[i],<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span><span class="fu">rbind</span>(MC.Beta,pbeta)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(out)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;MC.Beta&quot;</span>,<span class="st">&quot;pbeta&quot;</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>colname<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">9</span><span class="sc">:</span><span class="dv">1</span>){</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  name<span class="ot">=</span><span class="fu">paste</span>(<span class="st">&quot;x=&quot;</span>,x[i])</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  colname<span class="ot">=</span><span class="fu">cbind</span>(name,colname)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(out)<span class="ot">=</span>colname</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>out</span></code></pre></div>
<pre><code>##              x= 0.1     x= 0.2    x= 0.3   x= 0.4    x= 0.5    x= 0.6    x= 0.7
## MC.Beta 0.008599237 0.05702393 0.1624211 0.316382 0.5001325 0.6839394 0.8457872
## pbeta   0.008560000 0.05792000 0.1630800 0.317440 0.5000000 0.6825600 0.8369200
##            x= 0.8    x= 0.9
## MC.Beta 0.9502078 0.9892903
## pbeta   0.9420800 0.9914400</code></pre>
</div>
<div id="section-4" class="section level3">
<h3>5.9</h3>
<p>The Rayleigh density <span class="math inline">\([156,(18.76)]\)</span> is <span class="math display">\[
f(x)=\frac{x}{\sigma^{2}} e^{-x^{2} /\left(2 \sigma^{2}\right)}, \quad x \geq 0, \sigma&gt;0
\]</span> Implement a function to generate samples from a Rayleigh <span class="math inline">\((\sigma)\)</span> distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X^{\prime}}{2}\)</span> compared with <span class="math inline">\(\frac{X_{1}+X_{2}}{2}\)</span> for independent <span class="math inline">\(X_{1}, X_{2} ?\)</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>rayleigh<span class="ot">=</span><span class="cf">function</span>(scale, n) {</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  rayleigh<span class="ot">=</span>antithetic<span class="ot">=</span><span class="fu">numeric</span>(n)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    U <span class="ot">=</span><span class="fu">runif</span>(n)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    V <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> U</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    rayleigh <span class="ot">=</span> scale <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    antithetic <span class="ot">=</span> scale <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(V))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    out<span class="sc">$</span>ray<span class="ot">=</span>rayleigh</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    out<span class="sc">$</span>ant<span class="ot">=</span>antithetic</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>scale<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>out<span class="ot">=</span><span class="fu">rayleigh</span>(scale, n)</span></code></pre></div>
<pre><code>## Warning in out$ray &lt;- rayleigh: 把公式左手强迫变成串列</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">=</span> <span class="fu">var</span>(out<span class="sc">$</span>ray)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">=</span>(<span class="fu">var</span>(out<span class="sc">$</span>ray) <span class="sc">+</span> <span class="fu">var</span>(out<span class="sc">$</span>ant) <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">cov</span>(out<span class="sc">$</span>ray, out<span class="sc">$</span>ant)) <span class="sc">/</span> <span class="dv">4</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>reduction <span class="ot">=</span> ((var1 <span class="sc">-</span> var2) <span class="sc">/</span> var1)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;reduction=&quot;</span>,<span class="dv">100</span><span class="sc">*</span>reduction,<span class="st">&quot;%&quot;</span>)</span></code></pre></div>
<pre><code>## reduction= 97.26594 %</code></pre>
</div>
<div id="section-5" class="section level3">
<h3>5.13</h3>
<p>Find two importance functions <span class="math inline">\(f_{1}\)</span> and <span class="math inline">\(f_{2}\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2}, \quad x&gt;1
\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[
\int_{1}^{\infty} \frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2} d x
\]</span> by importance sampling? Explain.</p>
<p>Solution: Consider <span class="math display">\[f_1(x) = e^{-x}, x \in (1,\infty)\]</span> and <span class="math display">\[f_2(x) = \frac{1}{x^2}, x \in (1,\infty)\]</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.02</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span> <span class="fu">exp</span>((<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">=</span> <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">=</span><span class="dv">1</span> <span class="sc">/</span> (x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>gs <span class="ot">=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)<span class="sc">==</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)),<span class="fu">expression</span>(f[<span class="dv">1</span>](x)<span class="sc">==</span><span class="dv">1</span><span class="sc">/</span>(x<span class="sc">^</span><span class="dv">2</span>)),<span class="fu">expression</span>(f[<span class="dv">2</span>](x)<span class="sc">==</span>x<span class="sc">*</span>e<span class="sc">^</span>{(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">4</span>}<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)))</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>),<span class="at">main=</span><span class="st">&#39;density function&#39;</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y1, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y2, <span class="at">lty =</span> <span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y<span class="sc">/</span>y1,<span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">main =</span> <span class="st">&#39;ratios&#39;</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y<span class="sc">/</span>y2, <span class="at">lty =</span> <span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">=</span> <span class="cf">function</span>(x) { <span class="fu">exp</span>(<span class="sc">-</span>x) }</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">=</span> <span class="cf">function</span>(x) { (pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>))<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> (x <span class="sc">&gt;=</span> <span class="dv">1</span>) }</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">=</span><span class="cf">function</span>(x) {x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)}</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">7</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">rexp</span>(m)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">rcauchy</span>(m)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>x2[<span class="fu">which</span>(x2 <span class="sc">&lt;</span> <span class="dv">1</span>)] <span class="ot">=</span> <span class="dv">1</span> </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">g</span>(x1) <span class="sc">/</span> <span class="fu">f1</span>(x1), <span class="fu">g</span>(x2) <span class="sc">/</span> <span class="fu">f2</span>(x2))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">=</span> se <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">=</span><span class="fu">c</span>(<span class="fu">mean</span>(fg[,<span class="dv">1</span>]), <span class="fu">mean</span>(fg[,<span class="dv">2</span>]))</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>se <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">sd</span>(fg[,<span class="dv">1</span>]), <span class="fu">sd</span>(fg[,<span class="dv">2</span>]))</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat, se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.4007885 0.4002660
## se        0.5858734 0.9582237</code></pre>
</div>
<div id="section-6" class="section level3">
<h3>5.14</h3>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[
\int_{1}^{\infty} \frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2} d x
\]</span> by importance sampling.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">=</span><span class="cf">function</span>(x) {x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)}</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fl">1e4</span>                 </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="fu">runif</span>(m) </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>u)  </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">=</span> <span class="fu">g</span>(x)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">=</span> <span class="fu">mean</span>(fg)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(theta.hat)</span></code></pre></div>
<pre><code>## [1] 0.4055885</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">=</span><span class="fu">integrate</span>(g,<span class="dv">1</span>,<span class="cn">Inf</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>theta</span></code></pre></div>
<pre><code>## 0.400626 with absolute error &lt; 5.7e-07</code></pre>
</div>
</div>
</div>
<div id="第4次作业解答" class="section level1">
<h1>第4次作业解答</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<ul>
<li><p>Exercises 6.5 and 6.A</p></li>
<li><p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</p></li>
<li><p>What is the corresponding hypothesis test problem?</p></li>
<li><p>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p></li>
<li><p>Please provide the least necessary information for hypothesis testing</p></li>
</ul>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="section-7" class="section level3">
<h3>6.5</h3>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(χ^2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m,<span class="at">expr =</span> {</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  (n<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">var</span>(x) <span class="sc">/</span> <span class="fu">qchisq</span>(alpha, <span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;coverage probability=&quot;</span>, <span class="fu">mean</span>(UCL <span class="sc">&gt;</span> <span class="dv">4</span>))</span></code></pre></div>
<pre><code>## coverage probability= 0.788</code></pre>
<p>the 0.95 confidence interval is<span class="math inline">\(\left[\bar{X}-\frac{S}{\sqrt{n}} t_{n-1}(0.975), \bar{X}+\frac{S}{\sqrt{n}} t_{n-1}(0.975)\right]\)</span></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m,<span class="at">expr =</span> {</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>(<span class="fu">mean</span>(x)<span class="sc">-</span><span class="dv">2</span>) <span class="sc">&lt;</span> <span class="fu">sd</span>(x) <span class="sc">*</span> <span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> n<span class="dv">-1</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;coverage probability=&quot;</span>, <span class="fu">mean</span>(prob))</span></code></pre></div>
<pre><code>## coverage probability= 0.904</code></pre>
<p>如果样本不是正态分布的，那么置信区间覆盖方差的概率就不一定接近0.95，但t-interval表现更稳健。</p>
</div>
<div id="a" class="section level3">
<h3>6.A</h3>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level<span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(X^2(1)\)</span>, (ii) Uniform<span class="math inline">\((0,2)\)</span>, and (iii) Exponential(rate=1).</p>
<p>In each case, test <span class="math inline">\(H_0 : \mu= \mu_0 ~~vs~~ H_0 : \mu \neq \mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(X^2(1)\)</span>, Uniform<span class="math inline">\((0,2)\)</span>, and Exponential(1), respectively.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>num<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">1000</span>) <span class="co"># 不同样本量</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>er<span class="ot">&lt;-</span><span class="cn">NULL</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> num){</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  cv<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  er1<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m,<span class="at">FUN =</span> <span class="cf">function</span>(o){</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="dv">1</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>((m<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n)<span class="sc">/</span>se)<span class="sc">&gt;=</span>cv</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  })) </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  er2<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m,<span class="at">FUN =</span> <span class="cf">function</span>(o){</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>((m<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n)<span class="sc">/</span>se)<span class="sc">&gt;=</span>cv</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  er3<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m,<span class="at">FUN =</span> <span class="cf">function</span>(o){</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  se<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>((m<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n)<span class="sc">/</span>se)<span class="sc">&gt;=</span>cv</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  er<span class="ot">&lt;-</span><span class="fu">cbind</span>(er,<span class="fu">c</span>(er1,er2,er3))</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(er)<span class="ot">&lt;-</span>num</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(er)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Chi(1)&quot;</span>,<span class="st">&quot;U(0,2)&quot;</span>,<span class="st">&quot;exp(1)&quot;</span>)</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(er)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">50</th>
<th align="right">100</th>
<th align="right">200</th>
<th align="right">500</th>
<th align="right">1000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Chi(1)</td>
<td align="right">0.0793</td>
<td align="right">0.0666</td>
<td align="right">0.0606</td>
<td align="right">0.0529</td>
<td align="right">0.0520</td>
</tr>
<tr class="even">
<td align="left">U(0,2)</td>
<td align="right">0.0483</td>
<td align="right">0.0525</td>
<td align="right">0.0469</td>
<td align="right">0.0487</td>
<td align="right">0.0492</td>
</tr>
<tr class="odd">
<td align="left">exp(1)</td>
<td align="right">0.0690</td>
<td align="right">0.0579</td>
<td align="right">0.0526</td>
<td align="right">0.0514</td>
<td align="right">0.0465</td>
</tr>
</tbody>
</table>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, <span class="math inline">\(0.651\)</span> for one method and <span class="math inline">\(0.676\)</span> for another method. We want to know if the powers are different at <span class="math inline">\(0.05\)</span> level.</p>
<ul>
<li><p>What is the corresponding hypothesis test problem?</p></li>
<li><p>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p></li>
<li><p>Please provide the least necessary information for hypothesis testing.</p></li>
</ul>
<p><strong>Solution.</strong></p>
<p><strong>1.</strong> <span class="math inline">\(H_0: \text{The two methods have the same power.} \leftrightarrow H_1: \text{The two methods have different powers.}\)</span></p>
<p><strong>2.</strong> McNemar test. Because it is equivalent to test whether the acceptance rates of the two methods are the same. Also, a contingency table can be naturally constructed as in <strong>3</strong>.</p>
<p><strong>3.</strong> For instance, consider the following contingency table.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">6510</span>, <span class="dv">3490</span>, <span class="dv">10000</span>, <span class="dv">6760</span>, <span class="dv">3240</span>, <span class="dv">10000</span>, <span class="dv">13270</span>, <span class="dv">6730</span>, <span class="dv">20000</span>), <span class="dv">3</span>, <span class="dv">3</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">&quot;Rejected&quot;</span>, <span class="st">&quot;Accepted&quot;</span>, <span class="st">&quot;total&quot;</span>),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">&quot;method A&quot;</span>, <span class="st">&quot;method B&quot;</span>, <span class="st">&quot;total&quot;</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>         ))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>mat</span></code></pre></div>
<pre><code>##          method A method B total
## Rejected     6510     6760 13270
## Accepted     3490     3240  6730
## total       10000    10000 20000</code></pre>
<p>The test statistic: <span class="math display">\[\chi^2 = \sum_{i,j=1}^2 \frac{(n_{ij}-n_{i+} n_{+j}/n)^2}{n_{i+}n_{+j}/n} \rightarrow \chi^2_1.\]</span> Note that <span class="math inline">\(\chi^2 = 13.9966\)</span> and the p-value is <span class="math inline">\(P(\chi^2_1 &gt; \chi^2) = 0.0001831415 &lt; 0.05\)</span>. Therefore, we reject the null hypothesis <span class="math inline">\(H_0\)</span>, that is, the powers are different at <span class="math inline">\(0.05\)</span> level.</p>
</div>
</div>
</div>
<div id="第5次作业解答" class="section level1">
<h1>第5次作业解答</h1>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercise 6.C</p>
<p>Repeat Examples <span class="math inline">\(6.8\)</span> and <span class="math inline">\(6.10\)</span> for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1, d}\)</span> is defined by Mardia as <span class="math display">\[
\beta_{1, d}=E\left[(X-\mu)^{T} \Sigma^{-1}(Y-\mu)\right]^{3}
\]</span> Under normality, <span class="math inline">\(\beta_{1, d}=0 .\)</span> The multivariate skewness statistic is <span class="math display">\[
b_{1, d}=\frac{1}{n^{2}} \sum_{i, j=1}^{n}\left(\left(X_{i}-\bar{X}\right)^{T} \widehat{\Sigma}^{-1}\left(X_{j}-\bar{X}\right)\right)^{3}
\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1, d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(n b_{1, d} / 6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2) / 6\)</span> degrees of freedom.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="多元正态性的偏度检验6.8" class="section level3">
<h3>多元正态性的偏度检验(6.8)</h3>
<p>假设为 <span class="math display">\[H_0:\beta_{1,d}=0 \leftrightarrow H_1:\beta_{1,d}\neq 0\]</span> 当多元总体为正态时，<span class="math inline">\(\frac{nb_{1,d}}{6}\)</span>的渐进分布为<span class="math inline">\(\chi_{d(d+1)(d+2)/6}^2\)</span>，对大的<span class="math inline">\(|\beta_{1,d}|\)</span>值拒绝原假设。<br />
对大小为<span class="math inline">\(n=10,20,30,50,100,500\)</span>的样本，估计基于<span class="math inline">\(\frac{nb_{1,d}}{6}\)</span>的渐进分布的多元正态性偏度检验在显著水平<span class="math inline">\(\alpha=0.05\)</span>下的第一类错误率，在正态极限分布下计算临界值向量并存储到<span class="math inline">\(b_0\)</span>中。并给出<em>mul.sk()</em>函数用来计算样本多元偏度统计量。</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>nn <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)  <span class="co"># 样本容量</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>                 <span class="co"># 显著性水平</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span>                        <span class="co"># 随机变量的维数</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="dv">1</span><span class="sc">-</span>alpha,<span class="at">df=</span>d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)<span class="sc">*</span><span class="dv">6</span><span class="sc">/</span>nn  <span class="co"># 每种样本容量临界值向量</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算多元样本偏度统计量</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>mul.sk <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x) <span class="co"># 样本个数</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  xbar <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(x) </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  sigma.hat <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">cov</span>(x) <span class="co"># MLE估计</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(x)){</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(x)){</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>      b <span class="ot">&lt;-</span> b<span class="sc">+</span>((x[i,]<span class="sc">-</span>xbar)<span class="sc">%*%</span><span class="fu">solve</span>(sigma.hat)<span class="sc">%*%</span>(x[j,]<span class="sc">-</span>xbar))<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b<span class="sc">/</span>(n<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算第一类错误的经验估计</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">200</span>)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>p.reject <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;numeric&quot;</span>,<span class="at">length =</span> <span class="fu">length</span>(nn)) <span class="co"># 保存模拟结果</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(nn)){</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  mul.sktests <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;numeric&quot;</span>,<span class="at">length =</span> m)</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(nn[i],<span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">0</span>,d))</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>    mul.sktests[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">mul.sk</span>(data)<span class="sc">&gt;</span>b0[i])</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>  p.reject[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(mul.sktests)</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>p.reject</span></code></pre></div>
<p>模拟结果为第一类错误的经验估计，总结如下:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>summ <span class="ot">&lt;-</span> <span class="fu">rbind</span>(nn,p.reject)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(summ) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span>,<span class="st">&quot;estimate&quot;</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(summ)</span></code></pre></div>
<p>模拟的结果说明渐进卡方分布对大小<span class="math inline">\(n\leq 50\)</span>的小样本并不合适，需要进一步求方差的精确值。</p>
</div>
<div id="多元正态性偏度检验的功效6.10" class="section level3">
<h3>多元正态性偏度检验的功效(6.10)</h3>
<p>类似例6.10，针对污染正态备择假设，通过模拟估计多元正态性偏度检验的功效，污染正态分布表示如下： <span class="math display">\[(1-\epsilon)N(0,I_d)+\epsilon N(0,100I_d),0 \leq \epsilon \leq 1\]</span> 对一列以<span class="math inline">\(\epsilon\)</span>为指标的备择假设估计其多元偏度检验的功效，并绘制检验功效的功效函数。显著性水平<span class="math inline">\(\alpha=0.1\)</span>，样本大小为<span class="math inline">\(n=30\)</span>。</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span>      <span class="co"># 样本大小</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2000</span>    <span class="co"># 重复次数</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.15</span>,<span class="fl">0.01</span>),<span class="fu">seq</span>(<span class="fl">0.15</span>,<span class="dv">1</span>,<span class="fl">0.05</span>))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(epsilon)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;numeric&quot;</span>,<span class="at">length =</span> N)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="dv">1</span><span class="sc">-</span>alpha,<span class="at">df=</span>d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)<span class="sc">*</span><span class="dv">6</span><span class="sc">/</span>n  <span class="co">#临界值</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 对这列epsilon分别求power</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> epsilon[j]</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  mul.sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 生成混合分布</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">size =</span> n,<span class="at">replace =</span> T,<span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e,e))</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    data1 <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(n,<span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">1</span>,d))</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    data2 <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(n,<span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">100</span>,d))</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> u<span class="sc">*</span>data1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">*</span>data2</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    mul.sktests[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">mul.sk</span>(data)<span class="sc">&gt;</span>b0)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  power[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(mul.sktests)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制功效函数</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsilon,power,<span class="at">type=</span><span class="st">&quot;b&quot;</span>,<span class="at">xlab=</span><span class="fu">bquote</span>(epsilon),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.1</span>,<span class="at">lty=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(power<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>power)<span class="sc">/</span>m)  <span class="co"># 绘制标准误差</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon,power<span class="sc">-</span>se,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon,power<span class="sc">+</span>se,<span class="at">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p>从图中可以看出，功效函数在两个端点<span class="math inline">\(\epsilon=0\)</span>和<span class="math inline">\(\epsilon=1\)</span>处与<span class="math inline">\(\alpha=0.1\)</span>对应的水平线相较，对于<span class="math inline">\(0&lt;\epsilon&lt;1\)</span>，经验功效函数要大于0.1，且在0.15左右达到最高。</p>
</div>
</div>
</div>
<div id="第7次作业解答" class="section level1">
<h1>第7次作业解答</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Exercise 8.2 (page 242, Statistical Computating with R).</p>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<ul>
<li><p>Unequal variances and equal expectations</p></li>
<li><p>Unequal variances and unequal expectations</p></li>
<li><p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p></li>
<li><p>Unbalanced samples (say, 1 case versus 10 controls)</p></li>
<li><p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p></li>
</ul>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="section-8" class="section level3">
<h3>8.2</h3>
<p>Implement the bivariate Spearman rank correlation test for independence [255] as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = “spearman”. Compare the achieved significance level of the permutation test with the p-value reported by cor.test on the same samples.</p>
<div id="spearman-rank-correlation-test" class="section level4">
<h4>Spearman rank correlation test</h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>Spearman_rank_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">B =</span> <span class="fl">1e4</span>){</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  t0 <span class="ot">=</span> <span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  perm <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">=</span> <span class="fu">c</span>(x,y)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    samp <span class="ot">=</span> <span class="fu">sample</span>(z)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    perm[i] <span class="ot">=</span> <span class="fu">cor</span>(samp[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)], samp[(<span class="fu">length</span>(x)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(z)], <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(perm)<span class="sc">&gt;=</span><span class="fu">abs</span>(t0))</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">statistic =</span> t0, <span class="st">&#39;p.value&#39;</span> <span class="ot">=</span> p_value))</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="independent-case" class="section level4">
<h4>Independent case</h4>
<p>We generate 50 samples from <span class="math inline">\(N(0,1)\)</span> for <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, respectively. We expect the p-value of the test is very large so that the null hypothesis would not be rejected.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Spearman_rank_test</span>(x, y)</span></code></pre></div>
<pre><code>## $statistic
## [1] -0.1708043
## 
## $p.value
## [1] 0.2293</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  x and y
## S = 24382, p-value = 0.2349
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##        rho 
## -0.1708043</code></pre>
<p>From the output of <code>Spearman_rank_test()</code> and <code>cor.test</code>, we can see the p-value of these two methods very close and both of them will not reject the null hypothesis, which mean two samples are independent.</p>
</div>
<div id="dependent-case" class="section level4">
<h4>Dependent case</h4>
<p>Consider the data <span class="math inline">\(X\sim N(0,1)\)</span>, <span class="math inline">\(Y_i = X_i + \varepsilon_i\)</span>, where <span class="math inline">\(\varepsilon_i\sim N(0,1)\)</span>. <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are highly dependent, we expect the p-value of the test is very small.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Spearman_rank_test</span>(x, y)</span></code></pre></div>
<pre><code>## $statistic
## [1] 0.6345738
## 
## $p.value
## [1] 0</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  x and y
## S = 7610, p-value = 1.431e-06
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.6345738</code></pre>
<p>From the output of <code>Spearman_rank_test()</code> and <code>cor.test</code>, we can see p-value of two methods are 0, which means we would reject the null hypothesis, i.e. two samples are not independent.</p>
</div>
</div>
<div id="discussion-1" class="section level3">
<h3>Discussion</h3>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<ul>
<li><p>Unequal variances and equal expectations</p></li>
<li><p>Unequal variances and unequal expectations</p></li>
<li><p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p></li>
<li><p>Unbalanced samples (say, 1 case versus 10 controls)</p></li>
<li><p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p></li>
</ul>
<div id="unequal-variances-and-equal-expectations" class="section level4">
<h4>Unequal variances and equal expectations</h4>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>Tn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, size, <span class="at">k =</span> <span class="dv">3</span>){</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">=</span> size[<span class="dv">1</span>]</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">=</span> size[<span class="dv">2</span>]</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> n1<span class="sc">+</span>n2</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(z)) </span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">=</span> <span class="fu">data.frame</span>(z,<span class="dv">0</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">=</span> z[ix,]</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  NN <span class="ot">=</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k =</span> k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">=</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  b2 <span class="ot">=</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  i1 <span class="ot">=</span> <span class="fu">sum</span>(b1<span class="sc">&lt;</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  i2 <span class="ot">=</span> <span class="fu">sum</span>(b2<span class="sc">&gt;</span>n1<span class="fl">+0.5</span>)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  (i1<span class="sc">+</span>i2)<span class="sc">/</span>(k<span class="sc">+</span>n)</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, size, k, <span class="at">R =</span> R){</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">=</span> <span class="fu">boot</span>(<span class="at">data =</span> z, <span class="at">statistic =</span> Tn, <span class="at">R =</span> R, <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">size =</span> size, <span class="at">k =</span> k)</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>  stat <span class="ot">=</span> <span class="fu">c</span>(res<span class="sc">$</span>t0, res<span class="sc">$</span>t)</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>  p_val <span class="ot">=</span> <span class="fu">mean</span>(stat<span class="sc">&gt;</span>stat[<span class="dv">1</span>])</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p_val)</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>p_val <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y, <span class="at">R =</span> <span class="dv">999</span>, <span class="at">k =</span> <span class="dv">3</span>){</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">as.matrix</span>(x)</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">as.matrix</span>(y)</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>  n1 <span class="ot">=</span> <span class="fu">nrow</span>(x)</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>  n2 <span class="ot">=</span> <span class="fu">nrow</span>(y)</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">=</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>  p_nn <span class="ot">=</span> <span class="fu">eqdist.nn</span>(z, <span class="at">size =</span> N, k, <span class="at">R =</span> R)</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>  p_energy <span class="ot">=</span> <span class="fu">eqdist.etest</span>(z,<span class="at">sizes=</span>N,<span class="at">R =</span> R)<span class="sc">$</span>p.value</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>  p_ball <span class="ot">=</span> <span class="fu">bd.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">num.permutations =</span> R)<span class="sc">$</span>p.value</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(p_ball) <span class="ot">=</span> <span class="st">&quot;ball&quot;</span></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">NN =</span> p_nn, <span class="at">energy =</span> p_energy, p_ball))</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="unequal-variances-and-equal-expectations-1" class="section level4">
<h4>Unequal variances and equal expectations</h4>
<p>Generate <span class="math inline">\(X_1,\cdots,X_{50}\)</span> from <span class="math inline">\(N(0,1)\)</span>, <span class="math inline">\(Y_1,\cdots,Y_{50}\)</span> from <span class="math inline">\(N(0,1.7^2)\)</span>, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have equal mean and unequal variance.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">replicate</span>(<span class="dv">200</span>, <span class="at">expr =</span> {</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="dv">0</span>, <span class="fl">1.7</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_val</span>(x, y)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(res, <span class="dv">1</span>, <span class="cf">function</span>(x)<span class="fu">mean</span>(x<span class="sc">&lt;</span>alpha))</span></code></pre></div>
</div>
</div>
</div>
<div id="unequal-variances-and-unequal-expectations" class="section level2">
<h2>Unequal variances and unequal expectations</h2>
<p>Generate <span class="math inline">\(X_1,\cdots,X_{40}\)</span> from <span class="math inline">\(N(1,1)\)</span>, <span class="math inline">\(Y_1,\cdots,Y_{40}\)</span> from <span class="math inline">\(N(0.6,2^2)\)</span>, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have unequal mean and unequal variance.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">replicate</span>(<span class="dv">200</span>, <span class="at">expr =</span> {</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="fl">0.6</span>, <span class="dv">2</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_val</span>(x, y)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(res, <span class="dv">1</span>, <span class="cf">function</span>(x)<span class="fu">mean</span>(x<span class="sc">&lt;</span>alpha))</span></code></pre></div>
<div id="non-normal-distributions" class="section level4">
<h4>Non-normal distributions</h4>
<p>Generate <span class="math inline">\(X_1,\cdots, X_{40}\)</span> from unifrom distribution U(-3,3), generate <span class="math inline">\(Y_1,\cdots, Y_{60}\)</span> from</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">replicate</span>(<span class="dv">200</span>, <span class="at">expr =</span> {</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">40</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">rt</span>(<span class="dv">60</span>, <span class="dv">5</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_val</span>(x, y)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(res, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">mean</span>(x<span class="sc">&lt;</span>alpha))</span></code></pre></div>
</div>
<div id="unbalanced-samples" class="section level4">
<h4>Unbalanced samples</h4>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">replicate</span>(<span class="dv">200</span>, <span class="at">expr =</span> {</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">rt</span>(<span class="dv">300</span>, <span class="dv">5</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">p_val</span>(x, y)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(res, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">mean</span>(x<span class="sc">&lt;</span>alpha))</span></code></pre></div>
</div>
</div>
</div>
<div id="第8次作业解答" class="section level1">
<h1>第8次作业解答</h1>
<div id="question-6" class="section level2">
<h2>Question</h2>
<ul>
<li><p>Exercies 9.3 and 9.8 (pages 277-278, Statistical Computating with R).</p></li>
<li><p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to $R&lt; 1.2 $</p></li>
</ul>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="section-9" class="section level3">
<h3>9.3</h3>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a Cauchy <span class="math inline">\((\theta, \eta)\)</span> distribution has density function <span class="math display">\[
f(x)=\frac{1}{\theta \pi\left(1+[(x-\eta) / \theta]^{2}\right)}, \quad-\infty&lt;x&lt;\infty, \theta&gt;0
\]</span> The standard Cauchy has the Cauchy <span class="math inline">\((\theta=1, \eta=0)\)</span> density. (Note that the standard Cauchy density is equal to the Student <span class="math inline">\(\mathrm{t}\)</span> density with one degree of freedom.)</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="do">## standard Cauchy </span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span>(pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> xt)</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">&lt;-</span> <span class="fu">f</span>(y) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, <span class="at">mean =</span> y)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt) <span class="sc">*</span> <span class="fu">dnorm</span>(y, <span class="at">mean =</span> xt)</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span> <span class="co">#y is rejected</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="do">## MC过程图</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>m, x, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x[b<span class="sc">:</span>m]</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">1000</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>Qc <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(a) </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, a)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="do">## QQ图</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(Qc, Q, <span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="at">xlab=</span><span class="st">&quot;Standard Cauchy Quantiles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 直方图</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Qc, <span class="fu">f</span>(Qc))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-10" class="section level3">
<h3>9.8</h3>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x, y) \propto\left(\begin{array}{l}
n \\
x
\end{array}\right) y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1, \ldots, n, 0 \leq y \leq 1
\]</span> It can be shown (see e.g. <span class="math inline">\([23]\)</span> ) that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions are <span class="math inline">\(\operatorname{Binomial}(n, y)\)</span> and <span class="math inline">\(\operatorname{Beta}(x+a, n-x+b)\)</span>. Use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>x0<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>y0<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="do">###### generate the chain #####</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x0,y0) <span class="co">#initialize</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="at">size=</span>n,<span class="at">prob =</span> y)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>lab <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> X[lab<span class="sc">:</span>N, ]</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[,<span class="dv">1</span>],X[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;协方差矩阵</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 协方差矩阵</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(out) <span class="do">## 协方差矩阵</span></span></code></pre></div>
<pre><code>##             [,1]        [,2]
## [1,] 30062.95389 29.91243495
## [2,]    29.91243  0.02994719</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;相关系数矩阵</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 相关系数矩阵</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(out) <span class="do">## 相关系数矩阵</span></span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 1.0000000 0.9969145
## [2,] 0.9969145 1.0000000</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(X[<span class="dv">1</span>]),</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="at">ylab=</span><span class="fu">bquote</span>(X[<span class="dv">2</span>]), <span class="at">ylim=</span><span class="fu">range</span>(out[,<span class="dv">2</span>]))  <span class="do">## 分布图</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="discussion-2" class="section level3">
<h3>Discussion</h3>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R&lt;1.2\)</span></p>
<p>解答：</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算Gelman-Rubin statistic的函数</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>        }</span></code></pre></div>
<div id="section-11" class="section level4">
<h4>9.3</h4>
<p>先按照9.3题写出构造标准柯西分布的Metropolis chain的函数</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成标准柯西分布的Metropolis chain</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 提议函数仍取9.3中使用的对称正态分布 N(0,X[t]^2)</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># X1为初始值</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>Standard_Cauchy_Chain <span class="ot">&lt;-</span> <span class="cf">function</span>(N, X1){</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1    <span class="co">#初始值</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    Xt <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>]</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="fu">abs</span>(Xt))</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">dt</span>(Y,<span class="dv">1</span>)<span class="sc">*</span><span class="fu">dnorm</span>(Xt,<span class="dv">0</span>,<span class="fu">abs</span>(Y))<span class="sc">/</span><span class="fu">dt</span>(Xt,<span class="dv">1</span>)<span class="sc">/</span><span class="fu">dnorm</span>(Y,<span class="dv">0</span>,<span class="fu">abs</span>(Xt))</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>    U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(r <span class="sc">&gt;</span> <span class="dv">1</span>) r <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(U <span class="sc">&lt;=</span> r) X[i] <span class="ot">&lt;-</span> Y</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> X[i] <span class="ot">&lt;-</span> Xt</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>接下来不妨考虑生成4条上述Metropolis chain，每条样本量N=8000。</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span>      </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">8000</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span>     <span class="co">#burn-in length</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>)    <span class="co">#初始值</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成4条样本</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> N)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  X[i,] <span class="ot">&lt;-</span> <span class="fu">Standard_Cauchy_Chain</span>(N, X1[i])</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="co"># compute diagnostic statistics</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.127139</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 四条样本的psi</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="at">ylab=</span><span class="fu">bquote</span>(phi))</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lines</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">col=</span>i)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) </span></code></pre></div>
<p>实际上发现四条样本的psi图并没有呈现逼近同一分布的结果，这可能是因为Cauchy分布的期望和方差不均存在，进而导致的估计不稳定性，下面再画出<span class="math inline">\(\hat R\)</span>统计量v.s.样本量N的图。</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\hat R\)</span> 大概在样本为1000时达到收敛。</p>
</div>
<div id="section-12" class="section level4">
<h4>9.8</h4>
<p>先按照9.8题写出题中二元随机变量的Gibbs sampler，这里不妨取a=b=1。</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成二元随机变量的Gibbs sampler</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co"># X1为初始值</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>Bivariate.Gibbs <span class="ot">&lt;-</span> <span class="cf">function</span>(N, X1){</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> X1    <span class="co">#初始值</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>    X2 <span class="ot">&lt;-</span>  X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">25</span>,X2)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> X[i,<span class="dv">1</span>]</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,X1<span class="sc">+</span>a,<span class="dv">25</span><span class="sc">-</span>X1<span class="sc">+</span>b)</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>不妨还是考虑生成4条样本，每条样本量N=8000.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span>          </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">8000</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span>    <span class="co">#burn-in length</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">15</span>),<span class="fu">runif</span>(<span class="dv">4</span>)) <span class="co">#初始值</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co">#生成4条样本，每个第一维的放在X中，第二维的放在Y中</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>N)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>N)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  BG <span class="ot">&lt;-</span> <span class="fu">Bivariate.Gibbs</span>(N, X1[i,])</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> BG[,<span class="dv">1</span>]</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  Y[i, ] <span class="ot">&lt;-</span> BG[,<span class="dv">2</span>]</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>下面分别在每一个维度上考虑利用Gelman-Rubin method考虑样本的收敛情况。</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 先考虑第一维样本X</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAASFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6Ojo6kNtmAABmtv+QOgCQ2/+2ZgC2///bkDrbkJDb////tmb/25D//7b//9v///98m9zhAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGx0lEQVR4nO3dYZuaOBhGYdrtzLZTx7rrjP7/f1oQUUeEk5C8CYnP+bJeLQ16LwZU0OaoZmty34G1JyBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCPIDOmyaU9//GN2d9eUFtGt+9Tf2w4368wE6bC4sux//G9yZNeYD9Pn2e7i5f5onmbYgyHMOOm9Ck3NQU0wmQO2TrB99cvsp5qjBCCj1cHYJCDIF+nj9PfVXM8O5P+1TZAI0zEBdE7v5frjxLOg5M9pnswWdd168BbUUtwMPNCsSMtuLdfsvp6fYza2rS/VAx+P227sjUHN/47imTchukm5fsI6BHh1/NXf/XbY6qwz3Yh+v/zjtxa7T0e3fr0XIcjd/2DROQM2jFaxFaA0HiqfbI5CVCFkD7WaPg863m4fjPweQ03Dd0dADoFUIrQLo2DwcfhVCKwF6bCEgWmgFQqsGWoNQ3lfzvNbsQjZb0GFDH2a4DpddyOgpdti8xFpvZiGrOWg//SrDc7jMQuuepPtFswoVAJRXKDGQ/+dx/b+KsvJFlbAFZT2kLgQon1AZQBk3oVKAsgkVApRPqBSgbE+ycoAyCRUDlGsTElCs1eYHyiNUDlCmTagkoCxCBQHlESoJKItQEW93RL4TNqtcwxaUYxMy+tinO0VxP/2hz2Lv9Od32gGdrtK4uaxl+XBf/2FiIjOgM83UxSwBjzItkRnQ+fzEqcuhwh5jQqICt6DTP09GZPjZ/MtxmK4Dh3s8QCIiq918a/TtfeaS1QiPLg1RWcdB94MkEAoA+i/katRYB+ZRhpldhe+Cu/PR3/wZLu1S/dkLLme5BmQv5Au0b2eWbbtnag+TZ66I37VLfb51s7QxkL2QJ9DpvJ92D77rpuDJ+queD5sW0hrIXMgT6LTbPmx+NrPnRw0vMNpNzRzIWsgbqHvoW/jCict189sXeyDj90CWAdG3BQws7dHQV6DA94Me3zNToWVAcALi9ZsFJvd1MR+UqZARULz1Og1mKFQFkKWQNxCeIv61BJP0aTgzoaJfi92OZyVUC5CZUDVAVodDFQHZCNUDZCRk+JZrjMuhvDIRstmC4l0O5VU5QBEvh/LJYhOymoPiXQ7lk4FQRZO0zbC1AcU/AI2+4Pwo919RuP7/pgWyGs5u4PqAct3RUoBiC9UHFPu9uDyrNQWK+3Zu9AWzDPd17KifCERfMMtwd4Pn+NStJKCYQnUCRRSqFCieUK1A0YSqBYp2ilbi9RkNZ7eKmoGirKNioDhC2d4PijIcri3CGNEXzDLc1FrCicw+1YAzQNIARdiIbID457NSAQULmQA5/PhRMqBQIaOPnvHns9IBBQrVvwUFTtVWcxD+fJbPcMEFEBntxVb381mLieo+DvqyxmVGzwN0XLYZPRXQkj3akwH5P9GMjoOynILnmB+RzRaU6RQ813yIzF6s5jgFzz33t1ys5qCJU/DSvh8EOd2TZ5ukxwGSgLpmtiUBXWvu6v/Q+V8vW2mi68Xs0hYECQgSEJQNqJgyAc0O+viPIywcY31TRX6xOjto9UAOL1ZnB60fiF+szg76BEB4vdjsoM8AFDSogGBQAcGgAoJBBVRjAoIEBAkIEhAkIEhAkIAgAUECggQECQgSEBQfaN/A15o356+Fvyw4vjHf9fc9Fg/hXnSg7tvx99P38bBp/27XPbrLguMb0Me/73fr8h7CvdhA/eUK098r3P820O77n8uC4xvUcKFIwBDuxQa6AMwu1f5Pviw4vkHr2L3crct/CPeiA502/6mLgYa27WMZFhzfoHVsf/bTWMAQ7sUG6icAmAa6a2EuC45vwCo+37pLRbYhQ3iUA2g/zNEhj67dTIoEctjI+2upQp8f7XRT5FOMp8nzha+hM2xrUeQkjTva6y9PLN1H9wr7oCMF91IfKH68/rpf0Pso7wTQTtJFHiiefmJr5h7u+tOLuiUuC45vQNtm+BWvxUM4pxerkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQJCBIQJCAIAFBAoIEBAkIEhAkIEhAkIAgAUECggQECQgSECQgSECQgCABQQKCBAQJCBIQ9BcyVYe/YU34XQAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 再考虑第二维样本Y</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Y, <span class="dv">1</span>, cumsum))</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>综合考虑两个维度的<span class="math inline">\(\hat R\)</span>统计量，大约在样本为4000时可以达到收敛。</p>
</div>
</div>
</div>
</div>
<div id="第9次作业解答" class="section level1">
<h1>第9次作业解答</h1>
<div id="question-7" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with R).</li>
<li>Suppose <span class="math inline">\(T_{1}, \ldots, T_{n}\)</span> are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_{i}=T_{i} I\left(T_{i} \leq \tau\right)+\tau I\left(T_{i}&gt;\tau\right), i=1, \ldots, n\)</span>. Suppose <span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_{i}\)</span> values are as follows:<span class="math display">\[0.54,0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_{i}\)</span> follows a mixture distribution).</li>
</ul>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="section-13" class="section level3">
<h3>11.3</h3>
<ol style="list-style-type: lower-alpha">
<li><p>Write a function to compute the <span class="math inline">\(k^{t h}\)</span> term in <span class="math display">\[
\sum_{k=0}^{\infty} \frac{(-1)^{k}}{k ! 2^{k}} \frac{\|a\|^{2 k+2}}{(2 k+1)(2 k+2)} \frac{\Gamma\left(\frac{d+1}{2}\right) \Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)}
\]</span> where <span class="math inline">\(d \geq 1\)</span> is an integer, <span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(\mathbb{R}^{d}\)</span>, and <span class="math inline">\(\|\cdot\|\)</span> denotes the Euclidean norm. Perform the arithmetic so that the coefficients can be computed for (almost) arbitrarily large <span class="math inline">\(k\)</span> and <span class="math inline">\(d\)</span>. (This sum converges for all <span class="math inline">\(a \in \mathbb{R}^{d}\)</span> ).</p></li>
<li><p>Modify the function so that it computes and returns the sum.</p></li>
<li><p>Evaluate the sum when <span class="math inline">\(a=(1,2)^{T}\)</span>.</p></li>
</ol>
<p>解:</p>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>thek <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a, d){</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">/</span><span class="fu">exp</span>(<span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">+</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">exp</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="fl">+1.5</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))<span class="co">#用到了gamma函数和阶乘的恒等式</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>sumk <span class="ot">&lt;-</span> <span class="cf">function</span>(a, d){</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">abs</span>(<span class="fu">thek</span>(k, a, d))<span class="sc">&gt;</span><span class="fl">1e-5</span>){<span class="co">#tolerance</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> s<span class="sc">+</span><span class="fu">thek</span>(k, a, d)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">length</span>(a)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sumk</span>(a,d)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;The sum =&quot;</span>, s)</span></code></pre></div>
<pre><code>## [1] &quot;The sum = 1.53215765372619&quot;</code></pre>
</div>
<div id="section-14" class="section level3">
<h3>11.5</h3>
<p>Write a function to solve the equation</p>
<p><span class="math display">\[
\begin{gathered}
\frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u \\
=\frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u
\end{gathered}
\]</span></p>
<p>for <span class="math inline">\(a\)</span>, where</p>
<p><span class="math display">\[
c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}}
\]</span></p>
<p>Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
<p>解:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="do">###11.5</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>beijif <span class="ot">&lt;-</span> <span class="cf">function</span>(u, kf){</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">+</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>kf)<span class="sc">^</span>(<span class="sc">-</span>(kf<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(a, kg){</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  ckl <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(kg<span class="dv">-1</span>)<span class="sc">/</span>(kg<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  LHS <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>(kg<span class="dv">-1</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>(kg<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((kg<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">integrate</span>(beijif, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> ckl, <span class="at">kf=</span>kg<span class="dv">-1</span>)<span class="sc">$</span>value</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  ckr <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>kg<span class="sc">/</span>(kg<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  RHS <span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>kg) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((kg<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(kg<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">integrate</span>(beijif, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> ckr, <span class="at">kf=</span>kg)<span class="sc">$</span>value</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>  LHS<span class="sc">-</span>RHS</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>solution5 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k))</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k)) {</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  solution5[i] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">kg=</span>k[i])<span class="sc">$</span>root</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a><span class="do">###11.4</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="cf">function</span> (a,kh) {</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(kh<span class="dv">-1</span>) <span class="sc">/</span> (kh<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)), <span class="at">df=</span>kh<span class="dv">-1</span>)) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>kh <span class="sc">/</span> (kh<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)), <span class="at">df=</span>kh))</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>solution4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k))</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k)) {</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>  solution4[i] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(h, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">kh=</span>k[i])<span class="sc">$</span>root</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a><span class="do">###Compare</span></span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">cbind</span>(<span class="at">k=</span>k, <span class="at">exercice4=</span>solution4, <span class="at">exercice4=</span>solution5))</span></code></pre></div>
<pre><code>##          k exercice4 exercice4
##  [1,]    4  1.492103  1.492103
##  [2,]    5  1.533556  1.533556
##  [3,]    6  1.562744  1.562744
##  [4,]    7  1.584430  1.584430
##  [5,]    8  1.601185  1.601185
##  [6,]    9  1.614521  1.614521
##  [7,]   10  1.625390  1.625390
##  [8,]   11  1.634419  1.634419
##  [9,]   12  1.642038  1.642038
## [10,]   13  1.648554  1.648554
## [11,]   14  1.654190  1.654190
## [12,]   15  1.659114  1.659114
## [13,]   16  1.663452  1.663452
## [14,]   17  1.667303  1.667303
## [15,]   18  1.670745  1.670745
## [16,]   19  1.673840  1.673840
## [17,]   20  1.676637  1.676637
## [18,]   21  1.679178  1.679178
## [19,]   22  1.681496  1.681496
## [20,]   23  1.683620  1.683620
## [21,]   24  1.685572  1.685572
## [22,]   25  1.687373  1.687373
## [23,]  100  1.720608  1.720608
## [24,]  500  1.729755  1.729755
## [25,] 1000  1.730907  1.730907</code></pre>
<p>两种方法结果完全一致。</p>
</div>
<div id="discussion-3" class="section level3">
<h3>Discussion</h3>
<p>Suppose <span class="math inline">\(T_{1}, \ldots, T_{n}\)</span> are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_{i}=T_{i} I\left(T_{i} \leq \tau\right)+\tau I\left(T_{i}&gt;\tau\right), i=1, \ldots, n\)</span>. Suppose <span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_{i}\)</span> values are as follows:<span class="math display">\[0.54,0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_{i}\)</span> follows a mixture distribution).</p>
<p>解:</p>
<p>Observed data likelihood: <span class="math display">\[L=\Pi_{i=1}^n\left(\frac{1}{\lambda} e^{-\frac{1}{\lambda} x_{i}}\right)^{k_{i}} \cdot\left(e^{-\frac{1}{\lambda} \tau}\right)^{1-k_{i}}\]</span> <span class="math display">\[\log L=n_{1} \cdot \log \frac{1}{\lambda}+\sum_{x_{i} \leq \tau}\left(-\frac{1}{\lambda} x_{i}\right)+n_{2} \cdot-\frac{1}{\lambda} \tau\]</span> <span class="math display">\[\frac{\partial \log L}{\partial\lambda}=n_{1} \cdot \left(-\frac{1}{\lambda}\right)+ \left(\sum_{x_{i} \leq \tau} \frac{1}{\lambda^2}x_{i}\right)+n_{2}\cdot\frac{1}{\lambda^2}  \tau\]</span> <span class="math display">\[\hat{\lambda}_{MLE}=\frac{\sum_{x_{i} \leq \tau} x_{i}+n_{2} \tau}{n_{1}}\]</span> Complete data likelihood: <span class="math display">\[L=\Pi_{i=1}^n \frac{1}{\lambda} e^{-\frac{1}{\lambda} x_{i}}\]</span> <span class="math display">\[\log L= n \cdot \log \frac{1}{\lambda}-\frac{1}{\lambda} \cdot  \Sigma_{x_{i} \leq \tau} x_{i}-\frac{1}{\lambda}  \Sigma_{x_{i} &gt; \tau} x_{i}\]</span> E-step: <span class="math display">\[\mathbb{E}\log L=n \cdot \log \frac{1}{\lambda}-\frac{1}{\lambda} \cdot \Sigma_{x_{i} \leq \tau} x_{i}- \frac{1}{\lambda}n_{2}\left(\tau+\lambda_{0}\right)\]</span> <span class="math display">\[\frac{\partial \mathbb{E} \log L}{\partial \lambda}=n\cdot \left(-\frac{1}{\lambda}\right)+\frac{1}{\lambda^2}\cdot\Sigma_{x_{i} \leq \tau} x_{i}+\frac{1}{\lambda^2}\cdot n_{2}\left(\tau+\lambda_{0}\right)=0\]</span> M-step: <span class="math display">\[\lambda_1=\frac{\Sigma_{x_{i} \leq \tau} x_{i}+n_{2}\left(\tau+\lambda_{0}\right)}{n}\]</span> <span class="math display">\[\hat{\lambda}_{EM}=\frac{\sum_{x_{i} \leq \tau} x_{i}+n_{2} \tau}{n_{1}}\]</span></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>,<span class="fl">0.48</span>,<span class="fl">0.33</span>,<span class="fl">0.43</span>,<span class="fl">1.00</span>,<span class="fl">1.00</span>,<span class="fl">0.91</span>,<span class="fl">1.00</span>,<span class="fl">0.21</span>,<span class="fl">0.85</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(data)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">&lt;</span>tau)</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> n<span class="sc">-</span>n1</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>lam0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>lam1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="co">#初始值</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">abs</span>(lam0<span class="sc">-</span>lam1)<span class="sc">&gt;</span><span class="fl">1e-10</span>) {</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>  lam0 <span class="ot">&lt;-</span> lam1</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># E step</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  E <span class="ot">&lt;-</span> <span class="cf">function</span>(lam) n<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span>lam)<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>lam<span class="sc">*</span><span class="fu">sum</span>(data[data<span class="sc">&lt;</span>tau])<span class="sc">-</span>n2<span class="sc">/</span>lam<span class="sc">*</span>(tau<span class="sc">+</span>lam0)</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># M step</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>  lam1 <span class="ot">&lt;-</span> <span class="fu">optimize</span>(E, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">2</span>, <span class="at">maximum =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>maximum</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a><span class="co"># MLE </span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a><span class="co"># lam &lt;- 1</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>lik <span class="ot">&lt;-</span> <span class="cf">function</span>(lam){</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>  lik1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data[data<span class="sc">&lt;</span>tau], <span class="cf">function</span>(x) {</span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dexp</span>(x,<span class="at">rate=</span><span class="dv">1</span><span class="sc">/</span>lam)</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>  lik2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data[data<span class="sc">==</span>tau],<span class="cf">function</span>(x){</span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">-</span><span class="fu">pexp</span>(tau,<span class="at">rate =</span> <span class="dv">1</span><span class="sc">/</span>lam)</span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prod</span>(<span class="fu">c</span>(lik1,lik2))</span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a>MLE <span class="ot">&lt;-</span> <span class="fu">optimize</span>(lik, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">2</span>, <span class="at">maximum =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>maximum</span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">cbind</span>(<span class="at">EM=</span>lam1, MLE))</span></code></pre></div>
<pre><code>##             EM       MLE
## [1,] 0.9642917 0.9643037</code></pre>
<p>结果相差很小.</p>
</div>
</div>
</div>
<div id="第10次作业解答" class="section level1">
<h1>第10次作业解答</h1>
<div id="question-8" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 1 and 5 (page 204, Advanced R)</li>
<li>Excecises 1 and 7 (page 214, Advanced R)</li>
</ul>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="p204-1" class="section level3">
<h3>P204-1</h3>
<p>Why are the following two invocations of <code>lapply()</code> equivalent?</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim))</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, mean, <span class="at">x =</span> x)</span></code></pre></div>
<p>答: mean(x,trim)实际上有两个参数x和trim</p>
<ul>
<li>第一种表达是构造了新的function,给定了x的值，只剩下一个参数trim, lapply可以直接对trim的每个取值调用新的函数求mean</li>
<li>第二种表达实际上把mean的参数x直接传到lapply里了, 也是对trim每个取值求mean</li>
</ul>
</div>
<div id="p204-5" class="section level3">
<h3>P204-5</h3>
<p>For each model in the previous two exercises, extract R2 using the function below.</p>
<div id="ex1" class="section level4">
<h4>Ex1</h4>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(formulas,lm,<span class="at">data=</span>mtcars)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="ex2" class="section level4">
<h4>Ex2</h4>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(bootstraps,<span class="cf">function</span>(t) <span class="fu">lm</span>(mpg<span class="sc">~</span>disp,<span class="at">data=</span>t))</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = t)
## 
## Coefficients:
## (Intercept)         disp  
##    30.60253     -0.04362  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = t)
## 
## Coefficients:
## (Intercept)         disp  
##    28.64791     -0.03843  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = t)
## 
## Coefficients:
## (Intercept)         disp  
##     27.6603      -0.0345  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = t)
## 
## Coefficients:
## (Intercept)         disp  
##    28.03387     -0.03405  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = t)
## 
## Coefficients:
## (Intercept)         disp  
##    28.28411     -0.03811  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = t)
## 
## Coefficients:
## (Intercept)         disp  
##     31.9801      -0.0479  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = t)
## 
## Coefficients:
## (Intercept)         disp  
##    30.57554     -0.04548  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = t)
## 
## Coefficients:
## (Intercept)         disp  
##    32.15614     -0.04978  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = t)
## 
## Coefficients:
## (Intercept)         disp  
##    31.63730     -0.05157  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = t)
## 
## Coefficients:
## (Intercept)         disp  
##    28.28013     -0.03661</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Ex1</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;这是Ex1 4个模型的R-square</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 这是Ex1 4个模型的R-square</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">lapply</span>(formulas,lm,<span class="at">data=</span>mtcars), rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ex2</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;这是Ex2 10个模型的R-square</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 这是Ex2 10个模型的R-square</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="fu">lapply</span>(bootstraps,<span class="cf">function</span>(t) <span class="fu">lm</span>(mpg<span class="sc">~</span>disp,<span class="at">data=</span>t)), rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7526902
## 
## [[2]]
## [1] 0.6961595
## 
## [[3]]
## [1] 0.6153573
## 
## [[4]]
## [1] 0.5598672
## 
## [[5]]
## [1] 0.6122787
## 
## [[6]]
## [1] 0.7464705
## 
## [[7]]
## [1] 0.7312463
## 
## [[8]]
## [1] 0.8065431
## 
## [[9]]
## [1] 0.7916834
## 
## [[10]]
## [1] 0.635318</code></pre>
</div>
</div>
<div id="p214-1" class="section level3">
<h3>P214-1</h3>
<p>Use <code>vapply()</code> to:</p>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every column in a numeric data frame.</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use <code>vapply()</code> twice.)</li>
</ol></li>
</ul>
<div id="a-1" class="section level4">
<h4>(a)</h4>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">b=</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">c =</span><span class="dv">9</span><span class="sc">:</span><span class="dv">12</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 每一列取标准差</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(<span class="fu">as.list</span>(df),sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        a        b        c 
## 1.290994 1.290994 1.290994</code></pre>
</div>
<div id="b" class="section level4">
<h4>(b)</h4>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>df2<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">b=</span><span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>,<span class="st">&quot;s&quot;</span>), <span class="at">c =</span><span class="dv">9</span><span class="sc">:</span><span class="dv">12</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(df2[<span class="fu">vapply</span>(df2, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))], sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        a        c 
## 1.290994 1.290994</code></pre>
</div>
</div>
<div id="p214-7" class="section level3">
<h3>P214-7</h3>
<p>Implement <code>mcsapply()</code>, a multicore version of <code>sapply()</code>. Can you implement mcvapply(), a parallel version of <code>vapply()</code>? Why or why not?</p>
<div id="mcsaplly" class="section level4">
<h4>mcsaplly()</h4>
<p>下面分配四个核来构造mcsapply函数</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>mcsapply <span class="ot">&lt;-</span> <span class="cf">function</span>(n, func){</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  core <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">4</span>)    <span class="co"># 使用4个核</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">parSapply</span>(core, n, func)   <span class="co"># 并行计算，n为次数，func为函数</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopCluster</span>(core)         <span class="co"># 关闭核</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>然后不妨尝试还是考虑前面习题中提及的计算置换数据的<span class="math inline">\(R^2\)</span></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>R2 <span class="ot">&lt;-</span> <span class="cf">function</span>(i){</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> mtcars[index,])</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">summary</span>(m)<span class="sc">$</span>r.squared)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用sapply函数进行10次</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, R2))</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用mcsapply函数进行10次</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">mcsapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, R2))</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用sapply函数进行10000次</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, R2))</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用mcsapply函数进行10000次</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">mcsapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>, R2))</span></code></pre></div>
<p>实际上，发现当样本量比较小的时候，并行计算反而比不并行所需要的时间更久，因为涉及到分配等额外消耗。当样本量比较大的时候并行计算会快很多。</p>
</div>
<div id="mcvapply" class="section level4">
<h4>mcvapply()</h4>
<p>由于R中并没有现成的parVapply函数，所以并行这一步的处理无法进行</p>
</div>
</div>
</div>
</div>
<div id="第11次作业解答" class="section level1">
<h1>第11次作业解答</h1>
<div id="question-9" class="section level2">
<h2>Question</h2>
<p>Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R).</p>
<ul>
<li>Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</li>
<li>Campare the computation time of the two functions with the function “microbenchmark”.</li>
<li>Comments your results.</li>
</ul>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>This example appears in <span class="math inline">\([40]\)</span>. Consider the bivariate density <span class="math display">\[
f(x, y) \propto\left(\begin{array}{l}
n \\
x
\end{array}\right) y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1, \ldots, n, 0 \leq y \leq 1
\]</span> It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions are Binomial <span class="math inline">\((n, y)\)</span> and Beta <span class="math inline">\((x+a, n-x+b)\)</span>. Use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<div id="gibbs-in-r" class="section level3">
<h3>Gibbs in R</h3>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">25</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>gibbsR<span class="ot">=</span><span class="cf">function</span>(a,b,n,N){</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)  <span class="co">#样本阵</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,]<span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>    X2<span class="ot">=</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">1</span>]<span class="ot">=</span><span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">25</span>,X2)</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>    X1<span class="ot">=</span>X[i,<span class="dv">1</span>]</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>    X[i,<span class="dv">2</span>]<span class="ot">=</span><span class="fu">rbeta</span>(<span class="dv">1</span>,X1<span class="sc">+</span>a,<span class="dv">25</span><span class="sc">-</span>X1<span class="sc">+</span>b)</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>X<span class="ot">=</span><span class="fu">gibbsR</span>(a,b,n,N)</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[,<span class="dv">1</span>],X[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>,<span class="at">main =</span> <span class="st">&quot;gibbsR&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="gibbs-in-c" class="section level3">
<h3>Gibbs in C</h3>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>dir<span class="ot">=</span><span class="st">&quot;D:/Software/Github/2021Fall/Statistical_Computing/Homework/hw10/&quot;</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="fu">paste0</span>(dir,<span class="st">&quot;R.cpp&quot;</span>))</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>Xc<span class="ot">=</span><span class="fu">gibbsC</span>(a,b,n,N)</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Xc[,<span class="dv">1</span>],Xc[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>,<span class="at">main=</span><span class="st">&quot;gibbsC&quot;</span>)</span></code></pre></div>
</div>
<div id="qq-plot" class="section level3">
<h3>QQ plot</h3>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X[,<span class="dv">1</span>],Xc[,<span class="dv">1</span>],<span class="at">xlab =</span> <span class="st">&quot;gibbsR&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;gibbsC&quot;</span>,<span class="at">main=</span><span class="st">&quot;第1维变量QQ图&quot;</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X[,<span class="dv">2</span>],Xc[,<span class="dv">2</span>], <span class="at">xlab =</span> <span class="st">&quot;gibbsR&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;gibbsC&quot;</span>,<span class="at">main=</span><span class="st">&quot;第2维变量QQ图&quot;</span>)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<blockquote>
<p>Rcpp和R产生的随机数的QQ图基本在一条直线上, 所以产生的随机数的分布基本一致。</p>
</blockquote>
</div>
<div id="time" class="section level3">
<h3>Time</h3>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>ts<span class="ot">=</span><span class="fu">microbenchmark</span>(<span class="at">gibbR=</span><span class="fu">gibbsR</span>(a,b,n,N), <span class="at">gibbC=</span><span class="fu">gibbsC</span>(a,b,N,n))</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<blockquote>
<p>Rcpp运行的平均时间是20ms左右, 但R里运行的时间50000ms左右,Rcpp的效率远高于R</p>
</blockquote>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
