<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jingguo Lan" />

<meta name="date" content="2021-12-22" />

<title>Introduction to StatComp21055</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to StatComp21055</h1>
<h4 class="author">Jingguo Lan</h4>
<h4 class="date">2021-12-22</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>StatComp21055</strong> is a simple R package developed to compare the performance of R and R++ (implemented through the R package <em>Rcpp</em>) for the ‘Statistical Computing’ course. Two functions are considered, namely, <em>gibbs</em> (generate random nubers using Gibbs sampler) and <em>vacc</em> (predicting the response using three variables: age, gender, and ily). For each function, both R and Rcpp versions are produced. Namely <em>gibbsR</em> and <em>vaccR</em> for R and ‘gibbC’ and <em>vaccC</em> for C++.</p>
<p>The R package ‘microbenchmark’ can be used to benchmark the above R and C++ functions.</p>
</div>
<div id="benchmarking-vaccr-and-vaccc" class="section level2">
<h2>Benchmarking <em>vaccR</em> and <em>vaccC</em></h2>
<p>The source R code for <em>vaccR</em> is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span> (age, female, ily) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fl">0.25</span> <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="fl">0.04</span> <span class="sc">*</span> age)) <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> ily</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">*</span> <span class="fu">ifelse</span>(female, <span class="fl">1.25</span>, <span class="fl">0.75</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">0</span>, p)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="dv">1</span>, p)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    p</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The above code involves ‘ifelse’, ‘pmax’, and ‘pmin’, which are known to be slow. On the other hand, the following <em>Rcpp</em> code is much faster.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>double <span class="fu">vacc3a</span>(double age, bool female, bool ily){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  double p <span class="ot">=</span> <span class="fl">0.25</span> <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="fl">0.04</span> <span class="sc">*</span> age)) <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> ily;</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> p <span class="sc">*</span> (female ? <span class="fl">1.25</span> <span class="sc">:</span> <span class="fl">0.75</span>);</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> std<span class="sc">::</span><span class="fu">max</span>(p, <span class="fl">0.0</span>);</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> std<span class="sc">::</span><span class="fu">min</span>(p, <span class="fl">1.0</span>);</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  return p;</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>NumericVector <span class="fu">vaccC</span>(NumericVector age, LogicalVector female,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                    LogicalVector ily) {</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  int n <span class="ot">=</span> <span class="fu">age.size</span>();</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  NumericVector <span class="fu">out</span>(n);</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(int <span class="at">i =</span> <span class="dv">0</span>; i <span class="sc">&lt;</span> n; <span class="sc">++</span>i) {</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    out[i] <span class="ot">=</span> <span class="fu">vacc3a</span>(age[i], female[i], ily[i]);</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  return out;</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>In order to empirically benchmark <em>vaccR</em> and <em>vaccC</em>, one generates 1,000 repicates of (age, female, ily), and save it in data{StatComp}. To load the file, one simply calls <em>data(data)</em>. The R code for benchmark <em>vaccR</em> and <em>vaccC</em> is as follows.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(StatComp21055)</span></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;StatComp21055&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     gibbsR</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(data)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(data)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>tm2 <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vR =</span> <span class="fu">vaccR</span>(age,female,ily),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">vC =</span> <span class="fu">vaccC</span>(age,female,ily)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(tm2)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">expr</th>
<th align="right">lq</th>
<th align="right">median</th>
<th align="right">uq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">vR</td>
<td align="right">64.40</td>
<td align="right">65.1</td>
<td align="right">65.7</td>
</tr>
<tr class="even">
<td align="left">vC</td>
<td align="right">35.95</td>
<td align="right">36.3</td>
<td align="right">36.6</td>
</tr>
</tbody>
</table>
<p>The above results show an evident computational speed gain of C++ against R.</p>
</div>
<div id="benchmarking-gibbsr-and-gibbsc" class="section level2">
<h2>Benchmarking <em>gibbsR</em> and <em>gibbsC</em></h2>
<p>The source R code for <em>vaccR</em> is as follows:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(N, thin) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>thin) {</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">1</span>, <span class="dv">3</span>, y <span class="sc">*</span> y <span class="sc">+</span> <span class="dv">4</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">1</span> <span class="sc">/</span> (x <span class="sc">+</span> <span class="dv">1</span>), <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> (x <span class="sc">+</span> <span class="dv">1</span>)))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    mat[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  mat</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The above R code involves two loops, which could be very slow even for R-3.01 or any higher version. The corresponding C++ code is as follows.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>NumericMatrix <span class="fu">gibbsC</span>(int N, int thin) {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  NumericMatrix <span class="fu">mat</span>(N, <span class="dv">2</span>);</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  double x <span class="ot">=</span> <span class="dv">0</span>, y <span class="ot">=</span> <span class="dv">0</span>;</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(int <span class="at">i =</span> <span class="dv">0</span>; i <span class="sc">&lt;</span> N; i<span class="sc">++</span>) {</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(int <span class="at">j =</span> <span class="dv">0</span>; j <span class="sc">&lt;</span> thin; j<span class="sc">++</span>) {</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">=</span> <span class="fu">rgamma</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span> <span class="sc">/</span> (y <span class="sc">*</span> y <span class="sc">+</span> <span class="dv">4</span>))[<span class="dv">0</span>];</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>      y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">1</span> <span class="sc">/</span> (x <span class="sc">+</span> <span class="dv">1</span>), <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> (x <span class="sc">+</span> <span class="dv">1</span>)))[<span class="dv">0</span>];</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mat</span>(i, <span class="dv">0</span>) <span class="ot">=</span> x;</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mat</span>(i, <span class="dv">1</span>) <span class="ot">=</span> y;</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mat);</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The R code for benchmarking <em>gibbsR</em> and <em>gibbsC</em> is as follows.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tm2 <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">vR =</span> <span class="fu">gibbsR</span>(<span class="dv">1000</span>, <span class="dv">10</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">vC =</span> <span class="fu">gibbsC</span>(<span class="dv">1000</span>, <span class="dv">10</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(tm2)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</span></code></pre></div>
<p>The results again show an evident computational speed gain of C++ against R.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(abess)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">=</span><span class="fu">generate.data</span>(<span class="dv">70</span>,<span class="dv">30</span>,<span class="dv">10</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>dat</span></code></pre></div>
<pre><code>## $x
##                x1           x2          x3           x4           x5
##  [1,] -0.62645381  0.475509529 -1.91435943 -0.164375832  0.398130155
##  [2,]  0.18364332 -0.709946431  1.17658331  0.420694643 -0.407528579
##  [3,] -0.83562861  0.610726353 -1.66497244 -0.400246744  1.324258630
##  [4,]  1.59528080 -0.934097632 -0.46353040 -1.370207878 -0.701231669
##  [5,]  0.32950777 -1.253633400 -1.11592011  0.987838267 -0.580614304
##  [6,] -0.82046838  0.291446236 -0.75081900  1.519745025 -1.001072181
##  [7,]  0.48742905 -0.443291873  2.08716655 -0.308740569 -0.668178607
##  [8,]  0.73832471  0.001105352  0.01739562 -1.253289756  0.945184953
##  [9,]  0.57578135  0.074341324 -1.28630053  0.642241306  0.433702150
## [10,] -0.30538839 -0.589520946 -1.64060553 -0.044709137  1.005159218
## [11,]  1.51178117 -0.568668733  0.45018710 -1.733218407 -0.390118664
## [12,]  0.38984324 -0.135178615 -0.01855983  0.002131860  0.376370292
## [13,] -0.62124058  1.178086997 -0.31806837 -0.630300334  0.244164924
## [14,] -2.21469989 -1.523566800 -0.92936215 -0.340968580 -1.426257342
## [15,]  1.12493092  0.593946188 -1.48746031 -1.156572363  1.778429287
## [16,] -0.04493361  0.332950371 -1.07519230  1.803141908  0.134447661
## [17,] -0.01619026  1.063099837  1.00002880 -0.331132036  0.765598999
## [18,]  0.94383621 -0.304183924 -0.62126669 -1.605513412  0.955136677
## [19,]  0.82122120  0.370018810 -1.38442685  0.197193439 -0.050565701
## [20,]  0.59390132  0.267098791  1.86929062  0.263175646 -0.305815420
## [21,]  0.91897737 -0.542520031  0.42510038 -0.985826700  0.893673702
## [22,]  0.78213630  1.207867806 -0.23864710 -2.888920672 -1.047298149
## [23,]  0.07456498  1.160402616  1.05848305 -0.640481703  1.971337386
## [24,] -1.98935170  0.700213650  0.88642265  0.570507636 -0.383632106
## [25,]  0.61982575  1.586833455 -0.61924305 -0.059723276  1.654145302
## [26,] -0.05612874  0.558486426  2.20610246 -0.098178744  1.512212694
## [27,] -0.15579551 -1.276592208 -0.25502703  0.560820729  0.082965734
## [28,] -1.47075238 -0.573265414 -1.42449465 -1.186458639  0.567220915
## [29,] -0.47815006 -1.224612615 -0.14439960  1.096777044 -1.024548480
## [30,]  0.41794156 -0.473400636  0.20753834 -0.005344028  0.323006503
## [31,]  1.35867955 -0.620366677  2.30797840  0.707310667  1.043612458
## [32,] -0.10278773  0.042115873  0.10580237  1.034107735  0.099078487
## [33,]  0.38767161 -0.910921649  0.45699881  0.223480415 -0.454136909
## [34,] -0.05380504  0.158028772 -0.07715294 -0.878707613 -0.655781852
## [35,] -1.37705956 -0.654584644 -0.33400084  1.162964556 -0.035922423
## [36,] -0.41499456  1.767287269 -0.03472603 -2.000164945  1.069161461
## [37,] -0.39428995  0.716707476  0.78763961 -0.544790740 -0.483974930
## [38,] -0.05931340  0.910174229  2.07524501 -0.255670709 -0.121010111
## [39,]  1.10002537  0.384185358  1.02739244 -0.166121037 -1.294140004
## [40,]  0.76317575  1.682176081  1.20790840  1.020463909  0.494312836
## [41,] -0.16452360 -0.635736454 -1.23132342  0.136221893  1.307901520
## [42,] -0.25336168 -0.461644730  0.98389557  0.407167603  1.497041009
## [43,]  0.69696338  1.432282239  0.21992480 -0.069654813  0.814702731
## [44,]  0.55666320 -0.650696353 -1.46725003 -0.247664342 -1.869788790
## [45,] -0.68875569 -0.207380744  0.52102274  0.695550807  0.482029504
## [46,] -0.70749516 -0.392807929 -0.15875460  1.146228357  0.456135603
## [47,]  0.36458196 -0.319992869  1.46458731 -2.403096215 -0.353400286
## [48,]  0.76853292 -0.279113303 -0.76608200  0.572739555  0.170489471
## [49,] -0.11234621  0.494188331 -0.43021175  0.374724407 -0.864035954
## [50,]  0.88110773 -0.177330482 -0.92610950 -0.425267722  0.679230774
## [51,]  0.39810588 -0.505957462 -0.17710396  0.951012808 -0.327101015
## [52,] -0.61202639  1.343038825  0.40201178 -0.389237182 -1.569082185
## [53,]  0.34111969 -0.214579409 -0.73174817 -0.284330662 -0.367450756
## [54,] -1.12936310 -0.179556530  0.83037317  0.857409778  1.364434929
## [55,]  1.43302370 -0.100190741 -1.20808279  1.719627299 -0.334281365
## [56,]  1.98039990  0.712666307 -1.04798441  0.270054901  0.732750042
## [57,] -0.36722148 -0.073564404  1.44115771 -0.422184010  0.946585640
## [58,] -1.04413463 -0.037634171 -1.01584747 -1.189113295  0.004398704
## [59,]  0.56971963 -0.681660479  0.41197471 -0.331032979 -0.352322306
## [60,] -0.13505460 -0.324270272 -0.38107605 -0.939829327 -0.529695509
## [61,]  2.40161776  0.060160440  0.40940184 -0.258932583  0.739589226
## [62,] -0.03924000 -0.588894486  1.68887329  0.394379168 -1.063457415
## [63,]  0.68973936  0.531496193  1.58658843 -0.851857092  0.246210844
## [64,]  0.02800216 -1.518394082 -0.33090780  2.649166881 -0.289499367
## [65,] -0.74327321  0.306557861 -2.28523554  0.156011676 -2.264889356
## [66,]  0.18879230 -1.536449824  2.49766159  1.130207267 -1.408850456
## [67,] -1.80495863 -0.300976127  0.66706617 -2.289123980  0.916019329
## [68,]  1.46555486 -0.528279904  0.54132734  0.741001157 -0.191278951
## [69,]  0.15325334 -0.652094781 -0.01339952 -1.316245160  0.803283216
## [70,]  2.17261167 -0.056896778  0.51010842  0.919803678  1.887474463
##                 x6          x7          x8          x9          x10         x11
##  [1,]  1.473881181  1.43506957 -1.09057358 -1.21536404 -1.227882590 -0.70756823
##  [2,]  0.677268492 -0.71037115  2.28465933 -0.02255863 -0.511219233  1.97157201
##  [3,]  0.379962687 -0.06506757 -0.88561757  0.70123930 -0.731194999 -0.08999868
##  [4,] -0.192798426 -1.75946874  0.11110643 -0.58748203  0.019752007 -0.01401725
##  [5,]  1.577891795  0.56972297  3.81027668 -0.60672794 -1.572863915 -1.12345694
##  [6,]  0.596234109  1.61234680 -1.10891000  1.09664022 -0.703333270 -1.34413012
##  [7,] -1.173576941 -1.63728065  0.30756662 -0.24750968  0.715932089 -1.52315577
##  [8,] -0.155642535 -0.77956851 -1.10689447 -0.15990171  0.465214906 -0.42196821
##  [9,] -1.918909820 -0.64117693  0.34765365 -0.62577825 -0.973902306  1.36092446
## [10,] -0.195258846 -0.68113139 -0.87326454  0.90043464  0.559217730  1.75379485
## [11,] -2.592327670 -2.03328560  0.07730312 -0.99419363 -2.432639745  1.56836473
## [12,]  1.314002167  0.50096356 -0.29686864  0.84925039 -0.340484927  1.29675557
## [13,] -0.635543001 -1.53179814 -1.18324224  0.80570229  0.713033195 -0.23759625
## [14,] -0.429978839 -0.02499764  0.01129269 -0.46760094 -0.659037386 -1.22415014
## [15,] -0.169318332  0.59298472  0.99160104  0.84842031 -0.036402623 -0.32781268
## [16,]  0.612218174 -0.19819542  1.59396745  0.98676986 -1.593286302 -2.41245028
## [17,]  0.678340177  0.89200839 -1.37271127  0.57562029  0.847792797 -0.31379287
## [18,]  0.567951972 -0.02571507 -0.24961093  2.02484205 -1.850388849  1.65987870
## [19,] -0.572542604 -0.64766045  1.15942453 -1.96235319 -0.323650632  0.13095310
## [20,] -1.363291256  0.64635942 -1.11422235 -1.16492093 -0.255248113  1.09588868
## [21,] -0.388722244 -0.43383274 -2.52850069 -1.37651921  0.060921227  0.48934096
## [22,]  0.277914132  1.77261118 -0.93590256  0.16767993 -0.823491629 -0.77891030
## [23,] -0.823081122 -0.01825971 -0.96723946  1.58462908  1.829730485  1.74355935
## [24,] -0.068840934  0.85281499  0.04748859  1.67788895 -1.429916216 -0.07838729
## [25,] -1.167662326  0.20516290 -0.40373679  0.48829670  0.254137143 -0.97555379
## [26,] -0.008309014 -3.00804860  0.23149613  0.87867326 -2.939773695  0.07065982
## [27,]  0.128855402 -1.36611193 -0.42237241 -0.14487487  0.002415809 -1.51859953
## [28,] -0.145875628 -0.42410226  0.37411839  0.46897176  0.509665571  0.86377903
## [29,] -0.163910957  0.23680366 -0.36600577  0.37623548 -1.084720001  0.50156839
## [30,]  1.763552003 -2.34272312  1.19010145 -0.76104028  0.704832977 -0.35478133
## [31,]  0.762586512  0.96169663 -0.73732753 -0.29329493  0.330976350 -0.48842889
## [32,]  1.111431081 -0.60442573  0.29066665 -0.13484126  0.976327473  0.93629395
## [33,] -0.923206953 -0.75287728 -0.88484957  1.39384582 -0.843339880 -1.06240839
## [34,]  0.164341838 -1.55561159  0.20800648 -1.03698869 -0.970579905 -0.98382087
## [35,]  1.154825187 -1.45389374 -0.04773017 -2.11433515 -1.771531349  0.42424788
## [36,] -0.056521425  0.05633184 -1.68452065  0.76827822 -0.322470342 -0.45131348
## [37,] -2.129360648  0.50936941 -0.14422656 -0.81616062 -1.338800742  0.92508480
## [38,]  0.344845762 -2.09788296  1.18021367 -0.43610692  0.688156028 -0.19862081
## [39,] -1.904955446 -1.00436198  0.68139992  0.90470503  0.071280652  1.19485102
## [40,] -0.811170153  0.53577172  0.14324763 -0.76308626  2.189752359  0.49554471
## [41,]  1.324004321 -0.45303708 -1.19231644 -0.34106698 -1.157707599 -2.24515257
## [42,]  0.615636849  2.16536850  1.16922865  1.50242453  1.181688064 -1.33537136
## [43,]  1.091668956  1.24574667  0.07920171  0.52830771 -0.527368362  1.28277521
## [44,]  0.306604862  0.59549803 -0.45177375  0.54219136 -1.456628011  0.69079590
## [45,] -0.110158762  0.00488445  1.64202821 -0.13667336  0.572967370 -0.96706267
## [46,] -0.924312773  0.27936078 -0.76959232 -1.13673385 -1.433377705 -1.34579369
## [47,]  1.592913754 -0.70590613  0.30336096 -1.49662715 -1.055185019  1.03366539
## [48,]  0.045010598  0.62801715  1.28173742 -0.22338564 -0.733111877 -0.81177646
## [49,] -0.715128401  1.48021396  0.60222280  2.00171923  0.210907264  1.80172548
## [50,]  0.865223100  1.08342991 -0.30702226  0.22170382 -0.998920727  1.77154196
## [51,]  1.074440958 -0.81324426 -0.41841810  0.16437291  1.077850323 -1.45469137
## [52,]  1.895654774 -1.61887685  0.35513553  0.33262361 -1.198974383 -0.84565431
## [53,] -0.602997304 -0.10965570  0.51348111 -0.38520800  0.216637035 -1.25047966
## [54,] -0.390867821  0.44088937  0.01860740 -1.39875403  0.143087030  0.66728807
## [55,] -0.416222032  1.35099398  1.31844897  2.67574080 -1.065750091 -1.29076969
## [56,] -0.375657423 -1.31860948 -0.06583200 -0.42368609 -0.428623411 -2.03500354
## [57,] -0.366630946  0.36438459 -0.70029608 -0.29860151 -0.656179477  2.02134699
## [58,] -0.295677453  0.23349984  0.53732613 -1.79234173  0.959394327  1.00597349
## [59,]  1.441820410  1.19395526 -2.20178232 -0.24800823  1.556052636  0.81712360
## [60,] -0.697538292 -0.02790997  0.39197374 -0.24730392 -1.040796434 -0.66398828
## [61,] -0.388167506 -0.35729885  0.49696095 -0.25551038  0.930572409 -0.01128123
## [62,]  0.652536452 -1.14681414 -0.22487472 -1.78693810 -0.075445931  0.61967726
## [63,]  1.124772447 -0.51742048 -1.11714317  1.78466282 -1.967195349 -1.28123874
## [64,] -0.772110803 -0.36212377 -0.39499460  1.76358635 -0.755903643 -0.12426133
## [65,] -0.508086216  2.35055433  1.54983034  0.68960022  0.461149161  0.17574165
## [66,]  0.523620590  2.44653138 -0.74351448 -1.10074064  0.145106631  1.69277379
## [67,]  1.017754227 -0.16670328 -2.33171212  0.71450936 -2.442311321  0.64213272
## [68,] -0.251164588 -1.04366744  0.81224544 -0.24647032  0.580318685  1.28223303
## [69,] -1.429993447 -1.97293493 -0.50131066 -0.31978617  0.655051998  0.14054697
## [70,]  1.709121032  0.51467163 -0.51088657  1.36264429 -0.304508837 -1.11250268
##               x12         x13         x14          x15          x16         x17
##  [1,] -0.33967697  2.00571858  0.09535401  0.463658648  0.041998754 -0.09953695
##  [2,] -1.66476464 -2.07057148 -0.46281942  0.074778333  0.223422312 -0.43985764
##  [3,]  0.92885176  3.05574237 -1.46888216 -0.486836236 -1.010465086 -0.71851145
##  [4,]  1.41682683 -0.26135059  0.15268651  0.748910821  2.401222102 -0.55459760
##  [5,] -0.06272078 -0.45439326  1.77376261  0.464234581  0.801961790  1.24548918
##  [6,] -0.98090234  0.15756056 -0.64807093  0.129420458 -0.251207959 -1.25892135
##  [7,]  1.08715025  0.93338873 -0.19981748 -0.815460652  1.212889371 -0.21538448
##  [8,]  0.13932703  0.30282828  0.68924373 -0.040150452 -0.627258086 -2.47196171
##  [9,] -0.38627210 -1.95615022  0.03614551  0.781416978  1.711158507 -0.67416932
## [10,]  1.12358542  0.35353671  1.94353631  0.676452747 -0.394373553 -0.50129719
## [11,] -0.75984566  0.45042451  0.73721373 -0.482652526 -2.321490856  1.54232579
## [12,]  1.14895910  0.65955087  2.32133393 -0.669113468  1.364119195 -0.96201807
## [13,] -0.84247626 -1.03142073  0.34890935  0.512801322  1.132229133 -0.87217954
## [14,]  0.39141334 -2.37102288 -1.13391666  1.048909929 -0.774316319 -1.39762962
## [15,]  0.89137724 -0.32457631  0.42133527  0.121058163 -1.410374966  0.17980517
## [16,] -1.33525871 -0.94429875 -0.92455626 -0.313292885 -1.834527581  1.15409199
## [17,]  0.39812348 -0.76589000 -1.00706237 -0.880670730 -0.269013538 -1.19853361
## [18,] -0.11158680 -0.95377927 -0.18947433 -0.419286891 -1.833928577 -0.42572440
## [19,]  0.67574392 -0.39800445  0.93391670 -1.482751678 -0.814468019  1.36630861
## [20,] -0.78859794 -0.31121706  0.34391000 -0.697318199  0.163572122 -0.68429739
## [21,] -0.08698633  0.79609271  0.81402028  1.134965089  0.855519222  0.68551221
## [22,]  1.38228401  0.98642834  0.91534100  1.111931845 -0.819963127  0.38950354
## [23,]  0.16849016 -0.79453166 -0.17185213 -0.870777634 -0.123602760 -1.30539592
## [24,]  0.82319095 -0.30881797 -2.40223111  0.210731585  0.254948236  1.21688801
## [25,] -0.22089460  0.36144477  0.79590685  0.069395647  1.718926338  0.79517402
## [26,] -1.02939165  1.39879110  2.16911587 -1.662648853 -0.958543528 -0.48820251
## [27,] -0.01092569 -0.05607042  0.05838350  0.810839980 -1.604310262 -0.90399345
## [28,] -1.22499116 -1.69887349 -1.35491445 -1.912345796 -1.845609422 -0.39041842
## [29,] -2.59611139  0.23185255 -0.36755077 -1.246753429  0.555737185  0.81406342
## [30,]  1.16912259 -0.11909067 -0.93451758  0.998154445 -0.060119191 -0.56424928
## [31,] -1.08690882  1.77249285 -0.04163922 -0.540872745  0.772086304 -1.87420532
## [32,] -1.82608301  0.34342217  0.67611201 -0.216375791 -0.140839387 -0.14290471
## [33,]  0.99528181 -0.62304978  0.86643615 -1.621937293  0.393093926  0.77190401
## [34,] -0.01186178 -0.43952229  0.23517502 -1.450963965  0.224218574 -1.15911793
## [35,] -0.59962839 -0.50529679 -0.93397013  0.350909731  0.023541985 -0.23791553
## [36,] -0.17794799  0.18603514  0.81325217 -0.174546929 -0.622962660 -1.22219333
## [37,] -0.42598134  0.17641780  1.34831856 -0.591428470  1.262009381  0.11680621
## [38,]  0.99665878  0.91584821  2.25188278 -1.334027261 -0.405774043 -0.13249963
## [39,]  0.72766071  0.32017673 -0.49365243 -1.097298501  0.666763771 -0.03368478
## [40,] -1.72663060 -0.36668730  0.47409260  2.036103609  0.164639155 -0.62232642
## [41,]  0.35339850 -0.94061130  1.19369167 -0.326489593  1.781524475 -0.70936346
## [42,]  0.72681367  0.63470293 -0.11639547  0.774005212  0.711213964  0.87144541
## [43,]  0.66826098 -0.06248848  0.52485856  0.785006401 -0.337691156  0.10513802
## [44,] -2.42431731  0.18283787  0.21442148  0.763246080 -0.009148952 -0.18693527
## [45,] -0.23535743  1.10364102 -0.13444953  0.294808760 -0.125309208 -3.21318853
## [46,]  1.97963332  1.75203562  0.16850910 -1.252355924 -2.090846097 -1.27561870
## [47,]  0.79679454 -0.95381646  0.96473277 -1.009503753  1.697393895  0.76290632
## [48,] -1.70927618  1.64408046  0.40877891  0.751391195  1.063881154 -0.40681514
## [49,] -1.66366871 -0.86673353 -0.46643822 -1.308353513 -0.766616636 -1.20831778
## [50,]  0.49110955  0.26635219 -2.23978298  0.527540097  0.382007559 -0.43932266
## [51,] -0.17405549  0.22237049 -0.79506319 -0.533539574  0.241895904 -0.37558075
## [52,]  0.96129056 -0.27690851 -0.01995512 -0.398376014 -1.132759411 -0.50144240
## [53,]  0.29382666  1.39425304 -2.51442512 -0.789569450  1.489907414  0.49661258
## [54,]  0.08099936 -0.65891200  2.21095203 -0.230141136 -0.248247105  1.52088094
## [55,]  0.18366184  0.66053128 -1.48876223  0.877184842  0.183583708  0.98809183
## [56,]  0.16625504 -0.01325570 -1.16075188  0.453733178  0.404871009  1.24612253
## [57,] -1.26959907 -0.93148030  1.45773822 -0.232464148 -0.994124469 -0.32986733
## [58,]  2.34949332  1.21468914 -2.18987595  0.870005525 -1.085429330  0.84434471
## [59,] -1.41200541 -2.08834037  0.73906268  1.656003734 -0.048542555 -0.98107576
## [60,] -0.01696149 -0.52615247 -0.34400877 -0.006368929  0.576085601 -0.13922141
## [61,] -0.54431935 -1.54140257  0.45587674  0.470489453  0.073830532  2.18543791
## [62,]  1.80011233  0.19432107  0.87811026  0.278218649  0.705945571 -0.01282801
## [63,]  1.01144018  0.26442255 -0.95846392 -0.977902941  0.334980103 -0.30530893
## [64,] -0.56371656 -1.11873517 -0.70584485 -0.926586142  0.545387806 -0.58421346
## [65,]  0.20542080  0.65095296 -2.99694930  1.919770463 -1.402905906  0.77126850
## [66,]  1.16546195 -1.03290024 -0.96105232  0.881277788  0.677053891  2.10618936
## [67,]  2.23632284  0.65920150  0.38018825  0.742081772 -0.789800446  0.41215704
## [68,]  0.30226508  0.23782940  0.50506759  0.147573404 -0.465728889 -0.26126488
## [69,] -1.04250660  0.71527595  2.02705600  0.485388565 -0.104852065  2.07378365
## [70,] -0.98354231 -0.93848304  0.06462703  0.151856040 -1.647851087 -0.77883022
##               x18          x19          x20         x21         x22         x23
##  [1,]  1.13153251 -0.426529867 -0.572022722  1.54688133 -1.53421754  0.58764293
##  [2,] -0.42134513 -0.926404248 -0.825930679  0.17892097 -1.20630986 -0.15829958
##  [3,] -1.02174737 -0.928557925 -0.237584094 -0.28254659 -1.95002527 -0.29208541
##  [4,]  1.21830538 -0.718900602 -0.595326496 -0.76729878 -0.88404003 -1.41989896
##  [5,] -1.79976067 -0.414790570 -0.410742195 -0.57640424  0.97340599 -2.13831803
##  [6,] -0.30824994 -0.005667893  0.327991438 -0.91485584 -0.58097132 -0.02250010
##  [7,]  0.01551524  0.633448919 -1.163646612  0.36991096  1.73676738  0.26977095
##  [8,] -0.44231772 -0.509180774  0.760177665 -1.46768436 -0.17267532 -0.50296940
##  [9,] -1.63800773 -0.857008619 -0.002555836 -1.74536198 -0.93799253  0.63080739
## [10,] -0.64140116  1.616167577 -0.038227771 -0.66738180 -0.28459366  0.47456521
## [11,] -1.55703574  0.993866407 -2.036237420  1.08427901 -0.58901810 -0.34065906
## [12,]  1.92316365  0.696845859 -0.301229079  0.12283164 -0.44393143  0.04960156
## [13,] -1.85682963  1.699970673 -0.555646104 -0.49424939  0.05999657  1.29526319
## [14,] -2.10611844 -0.977741945  0.847295416  0.66958818  0.08223295  0.31462420
## [15,]  0.69764853  2.048817582  1.390820511 -0.35147885  0.75839752  0.80157250
## [16,]  0.90744441  1.226449324  1.231246215 -0.11498040  0.53966299  0.48605890
## [17,] -0.19598820  0.307023012 -1.113337462  0.07298694  0.77664765  1.72556106
## [18,] -0.20682049  0.624332984 -0.796053893  1.08877461  0.13217166  0.10243286
## [19,]  0.72504317  0.061341442 -0.089519877  1.29256874 -0.80686530 -0.98983707
## [20,]  1.39871896 -0.110825791 -1.059656888  1.28251129  0.44935009 -0.46044121
## [21,] -1.59055515 -1.576233560 -1.604312194  0.97905612  0.41264146  0.23766149
## [22,]  1.30449708  0.742589846  0.791350666  0.32946978 -0.40361405 -0.26939726
## [23,]  0.19601173  2.142323398  0.068156528  1.87963572 -0.38808828 -0.16955407
## [24,] -0.33934345  2.089772957  0.614396000  2.04289903  1.09518775  0.66486897
## [25,]  1.26514414  0.169794327 -1.203067753  1.32857637  1.34048004 -0.77555092
## [26,]  0.93977369 -0.107877789 -0.340454835 -0.21966864  0.11440555 -1.91926113
## [27,]  1.27795249  0.181994495 -1.171248634 -1.04004743 -0.39226462  2.01933254
## [28,] -0.29116014  1.145928178 -0.829414768  0.19294978  1.65235784  0.43521051
## [29,]  0.77617245  1.477298823  0.229212042 -0.55523625 -1.24369761  1.05016883
## [30,]  0.29572563  0.407944153 -0.814992918  0.27499089 -0.91192587 -0.31211484
## [31,] -0.51719955  1.114278735 -0.993445515 -0.55051341  0.85004347  0.09361762
## [32,]  1.75723302 -0.027075844 -1.306168459  0.92125989 -0.92531300 -2.15318775
## [33,]  0.16172682  0.497722203 -1.434221772  2.18945599  0.89358121  0.35799307
## [34,] -0.05468438  1.185640014 -0.862847933  0.96399479 -0.94100974  0.46786481
## [35,]  0.52897160  3.639573627  1.703799204  0.74181848  0.53895209 -0.90668883
## [36,]  0.38973452 -0.054002596 -0.655632596  0.03735656 -0.18197440 -0.52934992
## [37,] -0.70577141 -0.668147317 -1.113168626  2.18083369  0.89176759  1.34357672
## [38,] -0.05317848  0.445807957 -1.405505446 -0.07958520  1.32920821  0.46943406
## [39,]  2.60644449 -0.405825246 -0.150643687  1.37629503 -0.10346613 -0.25310509
## [40,] -0.07259310  0.635283145 -0.394006912  1.57531668  0.61506461  0.36910372
## [41,] -0.29627189  0.341248399  0.252069320  0.16037698 -1.79977240 -1.34670719
## [42,]  0.73433034  1.316167163 -0.282706438 -3.25322007 -0.26270514  1.17193543
## [43,]  0.40148075 -0.959776484  0.867667613 -0.32993049 -1.21014188 -1.90873634
## [44,] -0.53830108 -1.205575211  0.720091121  0.45708983  0.20447725 -1.00439081
## [45,] -1.08272281  1.567573058  1.056069601 -1.30410376 -0.01399410  0.67668751
## [46,]  0.84780141  0.225285800  0.243502060 -1.29117344 -0.23520084  1.15232174
## [47,]  0.11884502 -0.922410657  1.114362662  0.90637973 -0.18831865 -1.73275992
## [48,]  0.48224722 -1.073772410 -0.076552714 -2.79596150  0.95128307  0.60130886
## [49,] -0.29132480 -0.552358286  0.932925054  0.23356057 -0.15401479  0.34165031
## [50,] -1.65211027  0.590461401 -0.157981739 -0.26903594  1.85424450 -0.03528101
## [51,]  0.06909460 -0.527275411 -0.681509515 -0.65854506 -1.90416735 -0.62616502
## [52,]  2.39057670  1.341846164 -1.220101091  0.06334579  0.35929970 -0.85597121
## [53,] -1.46177169  0.243844628 -0.708912992  0.05447684  2.11453495  0.15177784
## [54,] -0.98480629  0.195880789 -0.748679598  0.24700932 -1.13574899  1.20637269
## [55,] -1.33605374 -0.015519729  0.576077526  0.12403555 -0.79625599 -1.48857788
## [56,] -0.36513161 -0.297577328 -0.052099464 -0.53525670 -0.39756945 -1.05037412
## [57,]  1.38145425 -0.167679147 -0.630337174  0.25848259  0.09172404  1.63787412
## [58,] -0.15331726  1.156478580 -0.898336066  1.38770887 -0.23869407 -1.20733418
## [59,] -0.25557163 -1.338764009  1.512685876  0.66717045 -0.46196236 -2.62615508
## [60,] -1.28862710  1.086768775 -0.236749293  1.49704945  1.92634061  0.01746327
## [61,]  0.06526642 -0.350684197 -1.248803422 -0.27488040  0.12205481  0.34419403
## [62,]  1.03532642  0.734723245 -0.430009336  0.58307584  1.09205058  0.01271984
## [63,]  2.26021579 -0.058414484  0.093299436  0.50335853 -2.97225748 -0.87345013
## [64,]  1.31469628 -1.345812904  0.833041089 -0.74324768  1.12848905  0.34280028
## [65,] -0.87002335  0.346905269 -0.084932478 -0.81687759  1.31200013 -0.17738775
## [66,] -0.50313004 -0.638404647  0.111853039  1.87028368 -0.48260797  0.92143325
## [67,]  0.60745556  1.124392355 -1.039435943 -0.82725304 -0.22485900  0.30094440
## [68,] -0.01004142 -0.827733031  0.796422814  0.95071269  1.66776531  0.69338675
## [69,]  0.27533030 -1.787780138  0.099903376 -0.26617235  0.04121853  0.32547191
## [70,] -1.31229878 -0.854010003  0.736959753 -1.09908218  1.03817485  0.40805102
##               x24          x25          x26         x27         x28
##  [1,]  0.75984226 -0.081991744  0.253137809  0.20791155 -1.16734642
##  [2,] -2.28715352  1.156263423  0.011497986  0.99292292  0.32335016
##  [3,]  0.51783826  0.486796337 -1.975783962  0.81385789 -0.32078302
##  [4,] -1.34723626  0.958848663 -0.426326724  0.99600558 -0.88595026
##  [5,]  0.36315986  0.177792371  0.612302560  1.73274427  0.15127817
##  [6,]  1.31475256  0.292250881  1.230814109  0.35704203  0.57936347
##  [7,] -0.44830591 -2.113340685 -1.270807808  0.15572633 -0.07916683
##  [8,] -0.80816447 -0.538047911 -0.650555664  1.55278866  0.84876764
##  [9,] -0.08626850  1.014025585 -2.443166237 -0.06406962 -2.51103349
## [10,]  1.58542427  0.101269641  0.996548595 -1.00821876  0.73847711
## [11,]  0.10105745 -1.218707372  0.005113528 -0.89289552 -0.57099429
## [12,]  0.14876221 -0.958376793  0.791024764 -0.65451462  0.28653902
## [13,] -0.54643467 -0.555797485 -0.563191537 -1.43378283  1.14761986
## [14,] -0.52767559  2.121875912  0.213826203  1.41818435  0.13955870
## [15,] -0.13987156 -0.179589988  0.977082664 -0.59388567  0.08892661
## [16,] -1.58941141 -0.644735408 -0.234161103  1.11897180 -2.63015932
## [17,]  1.23410417 -2.092583772  0.848660554  2.38408156 -1.21722083
## [18,] -0.33545485 -1.901870838  0.653970891 -0.40328649  0.74915258
## [19,] -2.00100251  1.222250276 -1.590570026  0.37010856 -1.41593292
## [20,] -0.01745840 -0.851220441  0.309423133 -0.57529301 -0.11238266
## [21,] -0.24096690  1.621202883 -2.485982190  2.91922881  0.30403201
## [22,] -1.79198940 -0.329102802 -0.278439107 -1.07891479 -0.35401280
## [23,]  2.04969151 -2.326409527 -0.552433759  1.17849133 -0.85124249
## [24,] -1.11721761  2.192998000  0.876042073  0.86960277 -1.46117308
## [25,] -1.35354954 -1.082479976  0.293483694  0.93116631  0.26425185
## [26,]  0.45130231 -0.506360967 -0.597222047  1.02468123 -1.90735794
## [27,]  1.03322742  0.095918957 -0.157203603  0.61297506 -0.92523127
## [28,] -0.19588570 -0.120165258  0.184185060  0.60819008 -0.11157129
## [29,]  0.22731039 -1.518667630 -1.013032014 -0.89289171 -0.96523443
## [30,] -1.10219975 -1.510585063 -0.679843405  0.45203561 -0.16289892
## [31,]  0.95527737  1.395604928 -1.242693614 -0.37471231  0.86018405
## [32,]  0.31283045 -0.708421944 -1.535018736  2.84018515  0.01809877
## [33,]  0.10100571  0.827938353 -0.524540013  0.73239345  0.13726246
## [34,]  0.74811541  1.707755837 -0.018527385  0.84051893  1.59888607
## [35,]  0.99896089 -0.779166557 -1.568147171 -2.21965212 -0.11130085
## [36,] -0.73251531 -0.706899069  0.467851674 -1.32746378  0.28545587
## [37,]  0.48089524 -1.992902511 -0.667828864 -0.97666070 -1.98390990
## [38,] -0.98945031  1.899876533  0.311082360 -0.58707587  0.03074022
## [39,]  2.22955905 -0.756206936  0.142551004 -0.56801282 -0.76000489
## [40,]  0.45673660 -0.377955780 -0.374034721  0.64364096 -1.22401322
## [41,] -0.03581544 -1.363954801 -1.944926376 -0.23730711  1.00236665
## [42,] -0.49044271  0.741958159 -1.597681314 -0.29857803 -0.02154142
## [43,] -0.22056661  1.610975996 -2.540657861  1.18956256  0.94532134
## [44,] -1.10120936  0.227387447  1.362047250 -2.10894120 -0.90849122
## [45,]  0.06347047 -0.400515674 -0.360666003 -0.07328200 -2.40220223
## [46,]  0.58352593 -1.669580400  1.936397311  0.86340287  0.16293805
## [47,] -0.51335885  1.490701097 -1.455883798  1.07470746  0.94320893
## [48,] -0.81255212  0.691487433  1.481905708 -0.20585263  2.54460486
## [49,] -1.62931991 -0.040977477  1.076119636 -0.43361383  0.88719093
## [50,]  0.56890571  1.204344853 -0.757488401 -0.18222378  1.06043677
## [51,]  0.33378331  1.298514964  0.714085544 -0.43107867 -0.61574789
## [52,] -0.21132256 -0.462217021  0.581384629 -0.42460961  0.35285488
## [53,] -0.55109793 -1.225773748 -0.146723902 -1.35381968 -0.47532813
## [54,]  0.25836113  0.963266754  1.506981777 -0.19659495  0.42205637
## [55,] -1.37521045  0.693211228 -0.279532643  0.23411614 -1.18355915
## [56,] -1.47275415 -0.501393166  2.027738733 -0.55720629 -0.38374958
## [57,] -1.44520967  3.153971417 -1.195740196 -1.11332527 -1.45966581
## [58,] -0.36128842 -2.549106895  1.312317892 -1.63063543  0.04577322
## [59,]  0.79070996 -0.008138085 -0.524007513 -0.38782388  0.45245611
## [60,]  0.71465785  1.138780641  0.354249509  1.72263202  0.05756587
## [61,] -0.56515352  1.482346468 -0.071674488 -0.55850030 -0.63869385
## [62,]  1.41801430  0.975845009 -0.133144306 -0.63666085 -0.23868132
## [63,] -1.14575678  0.148350293 -0.088077384  2.78138713 -1.64290262
## [64,] -0.49281782  0.788908757  0.917788931 -1.95725588 -0.22257457
## [65,] -0.73305227  0.557581220  0.031439264  0.14252790 -1.77556845
## [66,]  0.15923208 -0.027394393  1.358930582  0.66449880 -0.01546590
## [67,] -1.75119296 -0.877074959  0.113494845 -0.47862749  1.75104687
## [68,]  1.18483087  1.216243471  0.174306546  1.18368958  0.70420651
## [69,]  1.20703160 -0.351249812 -0.053480405  0.80543729  1.48101932
## [70,]  0.97764933 -0.294393117 -0.424758034  0.05331776  1.35288791
##                x29         x30
##  [1,] -0.329957836 -0.74532038
##  [2,]  0.363498741 -0.48647150
##  [3,] -1.827662733 -0.35303944
##  [4,]  0.893777744 -0.06230052
##  [5,] -0.719124934  1.61961511
##  [6,]  0.940509520  1.24621141
##  [7,] -1.871157591  2.00858996
##  [8,]  1.147002717 -1.85441951
##  [9,] -0.502991095 -0.46271438
## [10,]  1.425898368  1.04310383
## [11,] -0.019339956 -0.30383752
## [12,] -0.638073726  0.31808070
## [13,]  0.498271000 -0.64874901
## [14,] -0.058246735 -1.86890434
## [15,] -0.626216778 -1.20699658
## [16,] -0.894620761  1.89725806
## [17,]  2.410060215 -0.26158556
## [18,] -0.949647251  1.78798172
## [19,]  0.559151501  0.86730052
## [20,] -0.211414690  0.70258094
## [21,] -1.017854802  1.62353224
## [22,] -1.390190989 -1.59015871
## [23,] -1.488629309 -0.60999121
## [24,] -1.406044634 -0.31328113
## [25,] -1.496235482 -0.92212977
## [26,]  0.686145924 -0.25648061
## [27,] -0.236761631 -2.08285464
## [28,]  1.999142429 -1.41715398
## [29,]  0.633238683  0.61078101
## [30,]  1.648197547  0.24152080
## [31,]  0.502718643  1.30396482
## [32,]  0.845467412 -0.33452858
## [33,]  0.467247396 -0.38453990
## [34,] -0.402055064 -0.42116821
## [35,]  0.923526703 -0.95835523
## [36,] -0.008055641  0.24911631
## [37,]  1.033784238 -1.17887937
## [38,] -0.799126982  0.49559328
## [39,]  1.004233021 -0.17770431
## [40,] -0.311973356  0.77473394
## [41,] -0.886149585  1.24794638
## [42,] -1.922254896 -0.41621676
## [43,]  1.619700744 -0.42971794
## [44,]  0.519269905 -0.04652522
## [45,] -0.055849932 -0.65859154
## [46,]  0.696417610  1.60258408
## [47,]  0.053515679 -0.06367205
## [48,] -1.310283497  0.86882763
## [49,] -2.123066058  0.37837548
## [50,] -0.208078589  1.41568817
## [51,] -0.312786580 -0.20902676
## [52,] -1.058235710 -2.67804459
## [53,]  0.417223596  0.60918047
## [54,] -0.315451534 -1.03364018
## [55,]  0.825549134  0.49739150
## [56,]  1.291272038 -0.97389234
## [57,] -0.625104978 -0.09447191
## [58,] -0.875146755 -0.55397669
## [59,]  0.143356943 -0.24575958
## [60,]  1.425189633 -0.65478561
## [61,] -1.734749426 -0.98380524
## [62,] -0.837404647  0.19640746
## [63,] -0.715752615 -1.21652631
## [64,]  0.374820958 -0.28504286
## [65,]  2.383327962 -0.30034606
## [66,] -0.463912962 -0.63862050
## [67,] -0.426500402  1.74284790
## [68,] -1.703095214 -1.86940060
## [69,] -1.041497356  0.03118449
## [70,]  0.768734962 -1.20911413
## 
## $y
##             [,1]
##  [1,]   83.55837
##  [2,]  -79.22639
##  [3,]   57.48346
##  [4,] -535.71429
##  [5,]   46.55548
##  [6,] -150.68024
##  [7,] -209.42155
##  [8,] -212.89529
##  [9,] -153.29210
## [10,]  144.79305
## [11,] -394.78917
## [12,]  186.91369
## [13,] -192.13601
## [14,] -190.37871
## [15,]  545.72540
## [16,]  238.76026
## [17,]  262.32243
## [18,]   31.27464
## [19,]  -63.80065
## [20,] -102.38271
## [21,] -263.16554
## [22,] -177.05342
## [23,]  224.48093
## [24,]  128.04619
## [25,]  358.87738
## [26,] -589.38465
## [27,]  -14.64371
## [28,]  -50.19705
## [29,] -219.78587
## [30,]  -83.55623
## [31,]  285.05363
## [32,] -419.24500
## [33,] -123.46498
## [34,] -272.74057
## [35,] -498.24267
## [36,] -204.08595
## [37,]  223.22484
## [38,] -105.51662
## [39,] -343.53958
## [40,]  477.56572
## [41,] -332.72384
## [42,]  971.52458
## [43,]  -52.40933
## [44,] -366.35533
## [45,]  184.10421
## [46,]  -84.01286
## [47,] -419.07981
## [48,]  374.03217
## [49,]  228.49073
## [50,]  225.73671
## [51,] -469.32277
## [52,] -567.83235
## [53,]  225.65309
## [54,]  490.73432
## [55,]  111.23063
## [56,] -363.03602
## [57,]  223.21508
## [58,]  174.94572
## [59,] -344.73471
## [60,]  -54.98772
## [61,]  273.38115
## [62,] -323.79485
## [63,] -330.33833
## [64,] -155.65367
## [65,]  202.42394
## [66,]  349.01112
## [67,] -240.42782
## [68,]  111.42441
## [69,] -121.40165
## [70,]  412.50865
## 
## $beta
##  [1]   0.00000   0.00000   0.00000   0.00000 148.51367   0.00000 139.94825
##  [8] 121.99435   0.00000  33.66851   0.00000   0.00000  15.03216   0.00000
## [15]  44.70316   0.00000  30.31397   0.00000   0.00000   0.00000  35.69334
## [22]  42.36839 134.44887   0.00000   0.00000   0.00000   0.00000   0.00000
## [29]   0.00000   0.00000</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
